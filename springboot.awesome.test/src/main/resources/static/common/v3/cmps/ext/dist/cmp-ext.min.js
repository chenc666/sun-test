!function(){var VU=Cmp.util.ValueHelper,parse=function(s){return 0===(s=s.toLowerCase()).indexOf("#")?parseWeb(s):0===s.index("rgb(")?parseRgb(s):0===s.index("rgba(")&&parseRgba(s)},parseWeb=function(s){if(3!==(s=s.substring(1)).length&&6!==s.length)return!1;var r,g,b,v=parseInt(s,16);return!1===v?v:(3===s.length?(r=((r=(3840&v)>>8)<<4)+r,g=((g=(240&v)>>4)<<4)+g,b=((b=15&v)<<4)+b):(r=(16711680&v)>>16,g=(65280&v)>>8,b=255&v),[r,g,b,100])},parseRgb=function(s){var ix=(s=s.substring(4)).indexOf(")");ix>-1&&(s=s.substring(0,ix));var vs=s.split(",");if(3!=vs.length)return!1;var r=VU.toInteger(vs[0],!1),g=VU.toInteger(vs[1],!1),b=VU.toInteger(vs[2],!1);return!1!==r&&!1!==g&&!1!==b&&(r&=255,g&=255,b&=255,[r,g,b,100])},parseRgba=function(s){var ix=(s=s.substring(5)).indexOf(")");ix>-1&&(s=s.substring(0,ix));var vs=s.split(",");if(4!=vs.length)return!1;var r=VU.toInteger(vs[0],!1),g=VU.toInteger(vs[1],!1),b=VU.toInteger(vs[2],!1),a=VU.toFloat(vs[3],!1);return!1!==r&&!1!==g&&!1!==b&&!1!==a&&(r&=255,g&=255,b&=255,a=Math.round(100*a)%101,[r,g,b,a])},Color=function(r,g,b,a){var me=this,red=128,greed=128,blue=128,alpha=100;if(me.getRed=function(){return red},me.getGreen=function(){return greed},me.getBlue=function(){return blue},me.getAlpha=function(){return alpha},isS(r)){var vs=parse(r);vs&&(red=vs[0],greed=vs[1],blue=vs[2],alpha=vs[3])}else isN(r)&&(red=r%256,greed=isN(g)?g%256:128,blue=isN(b)?b%256:128,alpha=isN(a)?a%101:100)},PRO=Color.prototype={valueOf:function(){var me=this,a=me.getAlpha(),v=me.getRed()<<16+me.getGreen()<<8+me.getBlue();return 100===a?v+=255<<24:0!==a&&(v+=(a=Math.floor(a/100*255))<<24),v},getWebValue:function(){var me=this,r=me.getRed(),g=me.getGreen(),b=me.getBlue(),rel=["#"];return rel.push(r.toString(16)),rel.push(g.toString(16)),rel.push(b.toString(16)),rel.join("")},getRgbValue:function(){var me=this,r=me.getRed(),g=me.getGreen(),b=me.getBlue(),rel=["rgb("];return rel.push(r),rel.push(","),rel.push(g),rel.push(","),rel.push(b),rel.push(")"),rel.join("")},getRgbaValue:function(){var me=this,r=me.getRed(),g=me.getGreen(),b=me.getBlue(),a=me.getAlpha(),rel=["rgba("];return rel.push(r),rel.push(","),rel.push(g),rel.push(","),rel.push(b),rel.push(","),rel.push(a/100),rel.push(")"),rel.join("")},replaceAlpha:function(alpha){var me=this;return new PK.Color(me.getRed(),me.getGreen(),me.getBlue(),alpha)},mingle:function(color,offset){if(!color||isF(color.getRed))return null;var me=this;if(0===(offset=isN(offset)?offset%101:50))return new PK.Color(me.getRed(),me.getGreen(),me.getBlue(),me.getAlpha());if(100===offset)return new PK.Color(color.getRed(),color.getGreen(),color.getBlue(),color.getAlpha());var mc=(100-offset)/100,cc=offset/100,r=Math.round(me.getRed()*mc+color.getRed()*cc),g=Math.round(me.getGreen()*mc+color.getGreen()*cc),b=Math.round(me.getBlue()*mc+color.getBlue()*cc),a=me.getAlpha()*mc+color.getAlpha()*cc;return new Color(r,g,b,a)},toString:function(){var me=this;return 100===me.getAlpha()?me.getWebValue():me.getRgbaValue()}};PRO.web=PRO.getWebValue,PRO.rgb=PRO.getRgbValue,PRO.rgba=PRO.getRgbaValue,Color.parse=function(s){var vs=parse(s);if(vs)return new PK.Color(vs[0],vs[1],vs[2],vs[3])},Cmp.define("Cmp.util.Color",{factory:function(){return Color}})}(),function(){var limitTaskCount=20,timeoutTimes=3e4,retryTimes=3,taskList=[],toUrlParamString=function(o){var n,v,s,rel=[],flag=!1;for(n in o)flag?rel.push("&"):flag=!0,v=o[n],rel.push(n),rel.push("="),isS(v)||isN(v)?rel.push(v):isB(v)?rel.push(v?"true":"false"):isA(v)?rel.push(v.join(",")):isO(v)?rel.push(JSON.stringify(v)):isD(v)&&(rel.push(v.getFullYear()),rel.push("-"),(s=v.getMonth()+1)<10&&rel.push("0"),rel.push(s),rel.push("-"),s=v.getDate(),sv<10&&rel.push("0"),rel.push(s),rel.push(" "),(s=v.getHours())<10&&rel.push("0"),rel.push(s),rel.push(":"),(s=v.getMinutes())<10&&rel.push("0"),rel.push(s),rel.push(":"),(s=v.getSeconds())<10&&rel.push("0"),rel.push(s));return rel.join("")},HttpRequest=function(method,url,paramString,headerConfig,cb){var _request,_isLowVer=!1,createHttpRequest=function(){window.XMLHttpRequest?_request=new XMLHttpRequest:window.ActiveXObject&&(_request=new ActiveXObject("Microsoft.XMLHTTP"),_isLowVer=!0)};this.requst=function(){createHttpRequest(),_request.open(method||"GET",url,!0),"POST"===method&&isS(paramString)?_request.setRequestHeader("Content-type","application/x-www-form-urlencoded; charset=UTF-8"):_request.setRequestHeader("Content-type","charset=UTF-8"),_request.send(paramString),_request.onreadystatechange=function(){4==_request.readyState&&cb(200==_request.status?{result:_request.responseText}:_request.status>=500&&_request.status<600?{error:"服务器出现错误"}:{error:"指定的路径不存在"})}}},Task=function(cfg){var me=this,paramString=isO(cfg.param)?toUrlParamString(cfg.param):void 0,_requsting=!1,_runTime=0,_tryTime=0,_timeout=0,_querySeq=0;me.timeoutTask=new Cmp.util.DelayedTask({handler:function(){!0===_requsting&&(_runTime<_tryTime?(putLog("连接超时，自动重试连接次数:"+_runTime,2),startRequst()):Cmp.invoke(cfg.callback,cfg.scope,[{error:"连接超时"}]))},scope:me});var doRequst=function(seq){var url=[cfg.url];cfg.url.indexOf("?")>-1?url.push("&rbtv="):url.push("?rbtv="),url.push((new Date).getTime()),new HttpRequest(cfg.type,url.join(""),paramString,{},function(result){_querySeq===seq&&(me.timeoutTask.cancel(),_requsting=!1,Cmp.invoke(cfg.callback,cfg.scope,[result]))}).requst()},startRequst=function(){_runTime++,doRequst(++_querySeq),me.timeoutTask.run({delay:_timeout})};me.execute=function(timeout,tryTime){if(_requsting)return!1;_requsting=!0,_tryTime=tryTime,_timeout=timeout,startRequst()}},executeTask=function(){0<limitTaskCount&&taskList.length>0&&taskList.shift().execute(timeoutTimes,retryTimes)},Proxy={setTimeout:function(timeout){timeoutTimes=isN(timeout)&&timeout>1e4?timeout:3e4},setRetryTime:function(time){retryTimes=isN(time)&&time>0?time:3},setMaxTaskCount:function(count){limitTaskCount=isN(count)&&count>1?count:20},get:function(url,param,callback,scope){var rel=[url];isO(param)&&(url.indexOf("?")>-1?rel.push("&"):rel.push("?"),rel.push(toUrlParamString(param)));var task=new Task({type:"GET",url:rel.join(""),param:void 0,callback:callback,scope:scope});taskList.push(task),executeTask()},post:function(url,param,callback,scope){var task=new Task({type:"POST",url:url,param:param,callback:callback,scope:scope});taskList.push(task),executeTask()}};Cmp.define("Cmp.util.AjaxProxy",{factory:function(){return Proxy}})}(),function(){var Rel={toDateStringForCh:function(date){if(!isD(date))return"";var v,rel=[];return rel.push(date.getFullYear()),rel.push("年"),(v=date.getMonth()+1)<10&&rel.push("0"),rel.push(v),rel.push("月"),(v=date.getDate())<10&&rel.push("0"),rel.push(v),rel.push("日"),rel.join("")},toMonthStringForCh:function(date){if(!isD(date))return"";var v,rel=[];return rel.push(date.getFullYear()),rel.push("年"),(v=date.getMonth()+1)<10&&rel.push("0"),rel.push(v),rel.push("月"),rel.join("")},toDateString:function(date){if(!isD(date))return"";var v,rel=[];return rel.push(date.getFullYear()),rel.push("-"),(v=date.getMonth()+1)<10&&rel.push("0"),rel.push(v),rel.push("-"),(v=date.getDate())<10&&rel.push("0"),rel.push(v),rel.join("")},getDaysOfMonth:function(year,month){switch(month){case 3:case 5:case 8:case 10:return 30;case 1:return 0==year%400||0!=year%100&&0==year%4?29:28;default:return 31}}};Cmp.define("Cmp.util.Dates",{factory:function(){return Rel}})}(),function(){var Rel=function(target,keyEventName){var me=this,prevented=!1,bingedKeyEvent=!1;me.keyMaps={},me.eventProxy=new Cmp.util.EventProxy;var onKeyEvent=function(ev){var c=ev.keyCode;if(c=!!c&&c+"",c=me.keyMaps[c])if(isF(c.handler)){var args=[ev,target];isA(c.args)&&(args=args.concat(c.args)),!1!==c.handler.apply(c.scope||window,args)&&me.eventProxy.fire(ev,target)}else me.eventProxy.fire(ev,target);else prevented?ev.preventDefault():me.eventProxy.fire(ev,target)};me.bindKeyEvent=function(){bingedKeyEvent||(bingedKeyEvent=!0,target.on(keyEventName,onKeyEvent,me))},me.releaseKeyEvent=function(){bingedKeyEvent&&(bingedKeyEvent=!1,target.un(keyEventName,onKeyEvent,me))},me.preventKeyEvent=function(){prevented=!0},me.unpreventKeyEvent=function(){prevented=!1},me.distory=function(){me.releaseKeyEvent(),me.eventProxy.destory(),delete me.keyMaps,delete me.eventProxy}};(Rel.prototype={addListener:function(handler,scope){isF(handler)&&this.eventProxy.addListener(handler,scope)},removeListener:function(handler,scope){isF(handler)&&this.eventProxy.removeListener(handler,scope)},addKey:function(keyCode,handler,scope,args){var me=this;if(isO(keyCode)){scope=keyCode.scope,args=keyCode.args;var i,v;for(i in keyCode)"scope"!==i&&"args"!==i&&(v=keyCode[i],i+="",me.keyMaps[i]={handler:v,scope:scope,args:args})}else(isN(keyCode)||isS(keyCode))&&(keyCode+="",me.keyMaps[keyCode]={handler:handler,scope:scope,args:args})},removeKey:function(keyCode){var me=this;if(isA(keyCode))for(var n,i=0,len=keyCode.length;i<len;i++)n=keyCode[i]+"",delete me.keyMaps[n];else(isN(keyCode)||isS(keyCode))&&(keyCode+="",delete me.keyMaps[keyCode])}}).on=Rel.prototype.addListener,Rel.prototype.un=Rel.prototype.removeListener,Cmp.define("Cmp.util.KeyMap",{factory:function(){return Rel}})}(),function(){var Record=Cmp.extend(Cmp.util.Observable,{constructor:function(config,listeners){var editBatch,me=this,data={},keies=[],allowKeies=!1,length=0,editing=!1;me.addEvents("changed"),Record.superclass.constructor.call(me,{listeners:listeners});var putByInner=function(key,value){var k,v,i,ov,c=!1;isS(key)&&((ov={})[key]=value,key=ov);for(k in key)(v=key[k])!==(ov=data[k])&&(!allowKeies||allowKeies.indexOf(k)>-1)&&(i=keies.indexOf(k),void 0===v?(delete data[k],i>-1&&(keies.slice(i,1),length--)):(data[k]=v,i<0&&(keies.push(k),length++)),c=!0);return c},removeByInner=function(key){var ind,k,ov,c,rel;if(isS(key)){if(ov=data[key],delete data[key],void 0===ov)return;return(ind=keies.indexOf(key))>-1&&(keies.slice(ind,1),length--),ov}if(isA(key)){rel=[],c=!1;for(var i=0,len=key.length;i<len;i++)k=key[i],ov=data[k],delete data[key],void 0===ov?rel.push(void 0):(rel.push(ov),c=!0,(ind=keies.indexOf(k))>-1&&(keies.slice(ind,1),length--))}return c?rel:void 0};if(me.isEmpty=function(){return 0===length},me.get=function(key){return data[key]},me.put=function(key,value){return editing?editBatch.push({inkove:"putByInner",params:[key,value]}):putByInner(key,value)&&me.fireEvent("changed",me),me},me.remove=function(key){if(!editing){var c=removeByInner(key);return c&&me.fireEvent("changed",me),c}editBatch.push({inkove:"removeByInner",params:[key]})},me.count=function(){return length},me.keies=function(){return keies.slice(0)},me.values=function(){var i,rel=[];for(i in data)rel.push(data[i]);return rel},me.entrys=function(){var i,rel=[];for(i in data)rel.push({key:i,value:data[i]})},me.data=function(){return Cmp.apply({},data)},me.beginEdit=function(){return!1===editing&&(editBatch=[]),editing=!0,me},me.cancelEdit=function(){return editBatch=void 0,editing=!1,me},me.commit=function(){if(!0===editing){for(var b,i=0,batchs=editBatch.splice(0),len=batchs.length,c=!1;i<len;i++)"removeByInner"===(b=batchs[i]).inkove?void 0!==removeByInner(b.params[0])&&(c=!0):"putByInner"===b.inkove&&!0===putByInner(b.params[0],b.params[1])&&(c=!0);if(c)return me.fireEvent("changed",me),!0}return!1},me.endEdit=function(){me.commit(),me.cancelEdit()},isA(config.allowKeies)&&config.allowKeies.length>0&&(allowKeies=config.allowKeies.slice(0)),isO(config.value)){for(var k in config.value)(!allowKeies||allowKeies.indexOf(k)>-1)&&(data[k]=config.value[k],keies.push(k));length=keies.length}}});Cmp.define("Cmp.util.Record",{factory:function(){return Record}})}(),function(){var Record,UV=Cmp.util.ValueHelper,sort=function(records,sortInfo){if(!isA(records)||0==records.length||!sortInfo||!sortInfo.key)return records;var k=sortInfo.key,d="desc"==sortInfo.dir;return records.sort(function(r1,r2){var v1=r1.get(k),v2=r2.get(k);return d?-UV.compare(v1,v2):UV.compare(v1,v2)}),records},filter=function(records,filter){if(!isA(records)||0==records.length)return[];if(!filter)return records.slice(0);var comp=filter.compare;if(isF(comp))return rel=[],Cmp.each(records,function(r){comp.call(filter.scope||{},r)&&rel.push(r)}),rel;if(isS(filter.key)&&((o={})[filter.key]=filter.value,filter.key=o),isO(filter.key)){var i,v,av,c,o=filter.key,rel=[];return Cmp.each(records,function(r){c=!0;for(i in o)av=o[i],v=r.get(i),0!==UV.compare(v,av)&&(c=!1);c&&rel.push(r)}),rel}return records.slice(0)},doInsert=function(values){if(isO(values)&&!isA(values)&&(values=[values]),!isA(values))return!1;for(var r,rid,me=this,i=0,len=values.length,rel=[];i<len;i++)(r=me.createRecord(values[i]))&&(r.on("changed",onRecordChanged,me),!0===me.editing&&r.beginEdit(),me.values.push(r),rel.push(r),!1!==me.idKey&&(rid=r.get(me.idKey),me.idValues[rid]=r));return me.filterInfo&&(rel=filter(rel,me.filterInfo)),me.resultValues&&rel.length>0&&(Cmp.each(rel,function(r){me.resultValues.push(r)}),me.sortInfo&&(me.resultValues=sort(me.resultValues,me.sortInfo))),0!==rel.length&&rel},doRemove=function(records){if((isS(records)||records instanceof Record)&&(records=[records]),!isA(records))return!1;for(var v,r,ri,me=this,vs=me.values,idk=me.idKey,idvs=me.idValues,i=0,len=records.length,rel=[];i<len;i++)v=records[i],isS(v)?r=!!idvs&&idvs[v]:v instanceof Record&&(r=v,v=!!idk&&r.get(idk)),(ri=vs.indexOf(r))>-1&&(vs.splice(ri,1),idvs&&delete idvs[v],r.purgeListeners(),rel.push(r));return rel.length>0&&(me.resultValues=filter(me.values,me.filterInfo),me.resultValues=sort(me.resultValues,me.sortInfo),rel)},onRecordChanged=function(r){var me=this;!0!==me.editing&&(me.resultValues=filter(me.values,me.filterInfo),me.resultValues=sort(me.resultValues,me.sortInfo),me.fireEvent("edit",me,r),me.fireEvent("changed","edit",me,r))},EDIT_HANDLER={insert:doInsert,remove:doRemove},compareFilter=function(of,nf){if(of==nf)return!0;if(void 0==of||void 0==nf)return!1;var getNames=function(o){var ms=[];for(var i in o)ms.push(i);return ms},oms=getNames(of),nms=getNames(nf);if(!UV.compareArray(oms,nms))return!1;for(var n,ov,nv,i=0,len=oms.length;i<len;i++)if(n=oms[i],ov=of[n],nv=nf[n],0!==UV.compare(ov,nv))return!1;return!0};Cmp.define("Cmp.util.TableModel",{extend:"Cmp.util.Observable",requires:["Cmp.util.Record"],factory:function(ext,reqs){var superClass=ext.prototype;return Record=reqs[0],Cmp.extend(ext,{constructor:function(config){var me=this;config=config||{},me.keies=isA(config.keies)?config.keies:[],me.values=[],me.idKey=!1,me.idValues=!1,isN(config.idIndex)&&config.idIndex<me.keies.length&&(me.idValues={},me.idKey=me.keies[config.idIndex]),doInsert.call(me,config.values),me.resultValues=filter(me.values,config.filter),me.filterInfo=config.filter,me.resultValues=sort(me.resultValues,config.sort),me.sortInfo=config.sort,me.addEvents("sort","filter","edit","insert","remove","reload","changed"),superClass.constructor.call(me,config)},insert:function(values){var me=this;if(!0===me.editing)me.editBatch.push({invoke:"insert",params:values});else{var rs=doInsert.call(me,values);rs&&(me.fireEvent("insert",me,rs),me.fireEvent("changed","insert",me,rs))}return me},remove:function(records){var me=this;if(!0===me.editing)me.editBatch.push({remove:"remove",values:records});else{var rs=doRemove.call(me,records);rs&&(me.fireEvent("remove",me,rs),me.fireEvent("changed","remove",me,rs))}return me},removeByIndex:function(index){var me=this;if(!0!==me.editing){index=isN(index)?[index]:index;for(var ci,rs=[],i=0,len=isA(index)?index.length:0,crs=me.resultValues,count=crs.length;i<len;i++)(ci=index[i])>-1&&ci<count&&rs.push(crs[ci]);(rs=doRemove.call(me,rs))&&(me.fireEvent("remove",me,rs),me.fireEvent("changed","remove",me,rs))}return me},reload:function(values){var me=this;!0===me.editing&&me.editBatch.splice(0,me.editBatch.length);for(var vs=me.values,len=vs.length;len--;)vs[len].purgeListeners();return me.idKey&&(me.idValues={}),me.values=[],me.resultValues=[],Cmp.isArray(values)&&0!=values.length?(doInsert.call(me,values)&&(me.fireEvent("reload",me),me.fireEvent("changed","reload",me)),me):(me.fireEvent("reload",me),me.fireEvent("changed","reload",me),me)},getRecords:function(index,limit){var end,crs=this.resultValues;return(index=isN(index)?index:0)<0||index>=crs.length?[]:(limit=isN(limit)?limit:crs.length,(end=index+limit)>crs.length&&(end=crs.length),crs.slice(index,end))},sort:function(key,dir){var me=this,info=me.sortInfo;return info&&info.key===key&&info.dir===dir?me:(me.sortInfo={key:key,dir:dir},sort.call(me,me.resultValues,me.sortInfo),me.fireEvent("sort",me),me.fireEvent("changed","sort",me),me)},find:function(key,value){var callFn,crs=this.resultValues,rel=[];return isS(key)?callFn=function(r){return value===r.get(key)}:isO(key)?callFn=function(r){var rel=!0;for(var i in key)if((value=r.get(i))!==key[i]){rel=!1;break}return rel}:isF(key)&&(callFn=key),isF(callFn)&&Cmp.each(crs,function(r){!0===callFn(r)&&rel.push(r)}),rel},filter:function(filterInfo){var me=this;return compareFilter(me.filterInfo,filterInfo)?me:(me.filterInfo=filterInfo,me.resultValues=filter(me.values,me.filterInfo),me.resultValues=sort(me.resultValues,me.sortInfo),me.fireEvent("filter",me),me.fireEvent("changed","filter",me),me)},getAt:function(index){var crs=this.resultValues;if(!((index=isN(index)?index:0)<0))return crs[index]},getById:function(recordId){var me=this;return me.idValues?me.idValues[recordId]:void 0},count:function(){return this.resultValues.length},beginEdit:function(){var me=this;if(!me.editing){me.editBatch=[];for(var len=me.values.length;len--;)me.values[len].beginEdit()}return me.editing=!0,me},cancelEdit:function(){var me=this;delete me.editBatch;for(var len=me.values.length;len--;)me.values[len].cancelEdit();return me.editing=!1,me},commitEdit:function(){var me=this;if(!0===me.editing){for(var b,call,bs=me.editBatch.splice(0,me.editBatch.length),i=0,len=bs.length,c=!1,len=me.values.length;len--;)1==me.values[len].commit()&&(c=!0);for(c&&(me.resultValues=filter(me.values,me.filterInfo),me.resultValues=sort(me.resultValues,me.sortInfo));i<len;i++)b=bs[i],call=EDIT_HANDLER[b.invoke],isF(call)&&!1!==call.apply(me,b.params)&&(c=!0);return!0===c&&me.fireEvent("changed","commit",me),c}return!1},endEdit:function(){var me=this;me.commitEdit(),me.cancelEdit()},isEditing:function(){return!0===this.editing},createRecord:Cmp.emptyFn})}})}(),Cmp.define("Cmp.util.ArrayTableModel",{extend:"Cmp.util.TableModel",requires:["Cmp.util.Record"],factory:function(ext,reqs){ext.prototype;var RecordClass=reqs[0];return Cmp.extend(ext,{createRecord:function(value){var me=this;if(isA(value)){var ks=me.keies,i=value.length,len=ks.length,o={};for(len=i<len?i:len,i=0;i<len;i++)o[ks[i]]=value[i];return new RecordClass({allowKeies:ks,value:o})}return!1}})}}),function(){var HTML=[];HTML.push('<div class="c-flowitem-bar">'),HTML.push('<div class="c-flowitem-bk"></div>'),HTML.push('<div class="c-flowitem-anchor"><div class="c-flowitem-anchor-inner"></div></div>'),HTML.push("</div>"),HTML.push('<div class="c-flowitem-label"></div>'),HTML=HTML.join(""),Cmp.define("Cmp.flow.FlowItem",{extend:"Cmp.Widget",cls:!0,factory:function(ext,reqs){var superclass=ext.prototype;return Cmp.extend(ext,{setLabel:function(label){var me=this;me.labelBox?me.labelBox.update(label):me.label=label},setAnchorText:function(text){var me=this;me.anchorBox?me.anchorBox.update(text):me.anchor=text},active:function(){this.setState("active")},disable:function(){this.setState("disabled")},enable:function(){this.setState("enabled")},setState:function(state){var me=this;"active"!==state&&"disabled"!==state&&(state="enabled"),me.state!==state&&("enabled"!==me.state&&me.el.removeClass("c-flowitem-"+me.state),"enabled"!==state&&me.el.addClass("c-flowitem-"+state),me.state=state)},initComponent:function(){var me=this,cls=me.cls;isA(cls)?cls.unshift("c-flowitem"):cls=isS(cls)?["c-flowitem",cls]:"c-flowitem",me.cls=cls,superclass.initComponent.call(me)},doRender:function(){var dom,v,me=this;superclass.doRender.call(me),me.el.update(HTML),!0===me.allowedClick&&me.el.setAttribute("clickable","clickable"),"disabled"===me.state?me.el.addClass("c-flowitem-disabled"):"active"===me.state?me.el.addClass("c-flowitem-active"):me.state="enabled",dom=me.el.dom.firstChild.childNodes[1].firstChild,me.anchorBox=Cmp.get(dom),dom=me.el.dom.childNodes[1],me.labelBox=Cmp.get(dom),v=me.anchor,delete me.anchor,isS(v)&&me.setAnchorText(v),v=me.label,delete me.label,isS(v)&&me.setLabel(v),me.el.on("click",me.onClick,me)},onClick:function(){var me=this;!0===me.allowedClick&&"enabled"===me.state&&isF(me.handler)&&me.handler.call(me.scope||me,me)}})}})}(),Cmp.define("Cmp.flow.Flow",{extend:"Cmp.Widget",cls:!0,requires:["Cmp.flow.FlowItem"],factory:function(ext,reqs){var superclass=ext.prototype,FlowItem=reqs[0];return Cmp.extend(ext,{setActiveIndex:function(ix){var me=this;if(isN(ix)&&me.activeIndex!==ix){for(var it,i=0,len=isA(me.flowItems)?me.flowItems.length:0;i<len;i++)it=me.flowItems[i],i<ix?it.enable():i===ix?it.active():it.disable();me.activeIndex=ix}},initComponent:function(){var me=this,cls=me.cls;isA(cls)?cls.unshift("c-flow"):cls=isS(cls)?["c-flow",cls]:"c-flow",me.cls=cls,superclass.initComponent.call(me),me.addEvents("clickitem")},doRender:function(){var me=this;superclass.doRender.call(me);for(var it,its=me.stepItems,i=0,len=isA(its)?its.length:0,iits=[];i<len;i++)it=Cmp.apply({},its[i]),me.itemWidth&&(it.width=me.itemWidth),isS(it.anchorText)?it.anchor=it.anchorText:it.anchor=i+1+"",delete it.anchorText,(it=new FlowItem(it)).render(me.el),iits.push(it);delete me.stepItems,me.flowItems=iits;var ix=isN(me.activeIndex)?me.activeIndex:0;delete me.activeIndex,me.setActiveIndex(ix)}})}}),function(){var SelectionModel=function(cfg){var me=this;cfg&&Cmp.apply(me,cfg),me.inited=!1};SelectionModel.prototype={initStyle:function(grid){this.grid=grid,grid.addEvents("selchanged")},isAllowedSelect:function(){return!this.noselect},getCount:function(){var me=this;return me.noselect?0:isA(me.selections)?me.selections.length:0},clearSelection:function(){this.setSelections()},setSelections:function(sels){var me=this;me.noselect||(me.selections=sels,me.fireEvent("selchanged",me,me.grid))},getSelections:function(){var me=this;return me.noselect?[]:me.selections},getSelected:function(){var me=this;if(!me.noselect)return isA(me.selections)&&me.selections.length>0?me.selections[me.selections.length-1]:void 0},bindRowEvent:Cmp.emptyFn,releaseRowEvent:Cmp.emptyFn,bindCellEvent:Cmp.emptyFn,releaseCellEvent:Cmp.emptyFn,fireEvent:function(){var grid=this.grid;grid&&grid.fireEvent.apply(grid,arguments)}},Cmp.define("Cmp.grid.SelectionModel",{factory:function(){return SelectionModel}})}(),Cmp.define("Cmp.grid.RowSelectionModel",{extend:"Cmp.grid.SelectionModel",factory:function(ext){var superClass=ext.prototype;return Cmp.extend(ext,{initStyle:function(grid){var me=this;superClass.initStyle.call(me,grid),me.isAllowedSelect()&&grid&&grid.el&&grid.el.addClass("c-grid-rowselect"),me.rows={}},bindRowEvent:function(row){var me=this;me.isAllowedSelect()&&row.on("click",me.onClickRow,me)},releaseRowEvent:function(row){var me=this;row.un("click",me.onClickRow,me)},onClickRow:function(event,row){var me=this;row.getId();row.selected?(me._removeSelection(row),me.unSelected(row)):(me._addSelection(row),me.toSelected(row))},_addSelection:function(row){var me=this,r=row.record;if(me.single)me.selectedRow&&me.unSelected(me.selectedRow),me.setSelections([r]),me.selectedRow=row;else{var ss=me.getSelections();ss?ss.push(r):ss=[r],me.setSelections(ss)}},_removeSelection:function(row){var me=this;if(me.single)me.setSelections(),me.selectedRow=void 0;else{for(var ss=me.getSelections(),r=row.record,i=0,len=(ss=ss.slice(0)).length;i<len;i++)if(ss[i]===r){ss.splice(i,1);break}me.setSelections(ss)}},toSelected:function(row){row.el.addClass("c-grid-selected"),row.selected=!0},unSelected:function(row){row.el.removeClass("c-grid-selected"),row.selected=!1}})}}),function(){var HTML='<i class="fa"></i>';Cmp.define("Cmp.grid.CheckboxSelectionModel",{extend:"Cmp.grid.RowSelectionModel",factory:function(ext){var superClass=ext.prototype;return Cmp.extend(ext,{setSelections:function(ss){var me=this,count=isA(ss)?ss.length:0,rowCount=me.grid.getRowModel().getCount();if(superClass.setSelections.call(me,ss),0===count)me.headCls&&(me.headBox.removeClass(me.headCls),me.headCls=void 0);else if(rowCount===count){cls="c-grid-checkboxsel-full";me.headCls!==cls&&(me.headCls&&me.headBox.removeClass(me.headCls),me.headBox.addClass(cls),me.headCls=cls)}else{var cls="c-grid-checkboxsel-part";me.headCls!==cls&&(me.headCls&&me.headBox.removeClass(me.headCls),me.headBox.addClass(cls),me.headCls=cls)}},getColumnWidth:function(){return this.columnWidth||0},renderHead:function(box,colIndex,data){var me=this;box.addClass("c-grid-checkboxsel"),!0!==me.single&&(box.update(HTML),box.on("click",me.onClickHeadBox,me)),isN(me.width)&&(me.width=me.width+"px"),isS(me.width)&&box.setWidth(me.width),me.columnWidth=box.getWidth(),me.headBox=box},onClickHeadBox:function(ev){var r,me=this,rows=me.grid.getRowModel().getRows(),i=0,len=rows.length;if("c-grid-checkboxsel-full"===me.headCls){for(;i<len;i++)me.unSelected(rows[i]);me.clearSelection()}else{for(var ss=[];i<len;i++)r=rows[i],me.toSelected(r),ss.push(r.record);me.setSelections(ss)}},renderCell:function(box,record,row,rowIndex,colIndex,data){var me=this;box.addClass("c-grid-checkboxsel"),box.update(HTML),isS(me.width)&&box.setWidth(me.width)}})}})}(),function(){var SORT_BOX_HTML=[];Object.prototype.toString;SORT_BOX_HTML.push('<div class="c-grid-sort-uparrow fa fa-caret-up"></div>'),SORT_BOX_HTML.push('<div class="c-grid-sort-downarrow fa fa-caret-down"></div>'),SORT_BOX_HTML=SORT_BOX_HTML.join("");var Column=function(config){var me=this;config&&Cmp.apply(me,config),me.width=isN(me.width)?me.width+"px":me.width};Column.prototype={getColumnWidth:function(){return this.columnWidth||0},renderHead:function(box,colIndex,data){var me=this;!0===me.sortable?(me.sortBox=box.createChild({cls:"c-grid-sortbox",html:SORT_BOX_HTML}),box.on("click",function(){me.onClickHead(data)}),me.changeSotrStyle(data.sortInfo)):box.addClass("c-grid-nosort"),me.textBox=box.createChild({tag:"strong",html:me.text||""}),isS(me.width)&&box.setStyle("width",me.width),me.columnWidth=box.getWidth(),data.on("changed",me.onDataChanged,me)},renderCell:function(box,record,row,rowIndex,colIndex,data){var html,me=this,nm=me.dataIndex,v=nm?record.get(nm):void 0;return html=isF(me.render)?(html=me.render.call(me.scope||window,v,record,rowIndex,colIndex,data))||"":v?v+"":"",box.update(html),!0===me.displayTooltip&&box.setAttribute("title",html),isS(me.width)&&box.setStyle("width",me.width),me.style&&(delete(html=me.style).width,box.setStyle(html)),me.columnWidth||(me.columnWidth=box.getWidth()),v},onDataChanged:function(type,data){this.changeSotrStyle(data.sortInfo)},changeSotrStyle:function(sort){var me=this,nm=me.dataIndex,dir=me.sortDir,nnm=!!sort&&sort.key,ndir=sort?sort.dir:"asc";me.sortBox&&(nm!==nnm?(dir&&me.sortBox.removeClass("desc"===dir?"c-grid-sort-down":"c-grid-sort-up"),me.sortDir=!1):(ndir!==dir&&(me.sortBox.removeClass("desc"===dir?"c-grid-sort-down":"c-grid-sort-up"),me.sortBox.addClass("desc"===ndir?"c-grid-sort-down":"c-grid-sort-up")),me.sortDir=ndir))},onClickHead:function(data){var me=this,nm=me.dataIndex,dir=me.sortDir;nm&&data.sort(nm,"asc"===dir?"desc":"asc")}},Cmp.define("Cmp.grid.Column",{factory:function(){return Column}})}(),function(){var Column,ColumnModel=function(columns){var me=this;if(isA(columns)){for(var c,i=0,len=columns.length,cols=[];i<len;i++)c=columns[i],isO(c)&&(isF(c.renderHead)||(c=new Column(c)),cols.push(c));me.columns=cols}else me.columns=[]};ColumnModel.prototype={getCount:function(){return this.columns.length},getColumn:function(colIndex){return this.columns[colIndex]}},Cmp.define("Cmp.grid.ColumnModel",{requires:["Cmp.grid.Column"],factory:function(ext,reqs){return Column=reqs[0],ColumnModel}})}(),function(){var DH=Cmp.util.DomHelper,EMPTY_TABEL_HTML=['<table cellpadding="0" cellspacing="0">'];EMPTY_TABEL_HTML.push("<tbody></tbody></table>"),EMPTY_TABEL_HTML=EMPTY_TABEL_HTML.join("");var onDataChanged=function(){var me=this,view=me.view,grid=me.grid;grid.getSelectionModel().clearSelection(),view.renderBody(grid),view.layoutRows(grid)},GridView=function(cfg){var me=this;isO(cfg)&&Cmp.apply(me,cfg)};GridView.prototype={render:function(grid){var el,o,me=this,box=grid.body||grid.el;!0!==grid.hideHeader?(el=box.createChild({cls:"c-grid-head",html:'<div class="c-grid-row"></div>'}),grid.headBox=Cmp.get(el.dom.firstChild),me.renderHead(grid),grid.headWarp=el):box.addClass("c-grid-noheader"),el=box.createChild({cls:"c-grid-body",html:'<div class="c-grid-bodybox"></div>'}),grid.bodyBox=Cmp.get(el.dom.firstChild),me.renderBody(grid),(o=grid.footer)&&(isO(o)&&!isF(o.render)&&(o=!1),o&&isF(o.render)||(o=!1)),o?(el=box.createChild({cls:"c-grid-foot",html:'<div class="c-grid-footbox"></div>'}),grid.footBox=Cmp.get(el.dom.firstChild),o.render(grid.footBox),grid.footer=o):box.addClass("c-grid-nofoot");var sm=grid.getSelectionModel();sm&&isF(sm.initStyle)&&sm.initStyle(grid),grid.striped&&box.addClass("c-grid-striped"),grid.headWarp&&grid.bodyBox.on("scroll",function(){grid.headWarp.dom.scrollLeft=grid.bodyBox.dom.scrollLeft}),me.bindDataEvent(grid),me.layoutRows(grid,!0)},bindDataEvent:function(grid){grid.data&&isF(grid.data.on)&&grid.data.on("changed",onDataChanged,{view:this,grid:grid})},releaseDataEvent:function(grid){grid.data&&isF(grid.data.un)&&grid.data.un("changed",onDataChanged,{view:this,grid:grid})},layoutRows:function(grid,includHead){for(var cm=grid.getColumnModel(),i=0,len=cm.getCount(),rw=grid.bodyBox.getScrollWidth(),bw=grid.bodyBox.getWidth(),rm=grid.getRowModel(),w=0;i<len;i++)w+=cm.getColumn(i).getColumnWidth();rm.getRowsHeight()>grid.bodyBox.getHeight()&&(bw-=rw),w=bw>w?bw:w,rm.setRowWidth(w),includHead&&grid.headBox.setWidth(w+rw)},renderHead:function(grid){var bd,cm,tr,td,inner,box=grid.headBox;if(box){box.update(EMPTY_TABEL_HTML),bd=box.dom.firstChild.firstChild;var c,i=0,len=(cm=grid.getColumnModel()).getCount();for(tr=DH.createDom({tag:"tr",parentNode:bd});i<len;i++)c=cm.getColumn(i),td=DH.createDom({tag:"td",parentNode:tr}),inner=Cmp.get(DH.createDom({tag:"div",parentNode:td,cls:"c-grid-cell"})),c.renderHead(inner,i,grid.data)}},renderBody:function(grid){var box=grid.bodyBox,rm=grid.getRowModel(),data=grid.data,rs=data&&isF(data.getRecords)?data.getRecords():[];rm.renderRows(box,rs)}},Cmp.define("Cmp.grid.GridView",{factory:function(){return GridView}})}(),function(){var DH=Cmp.util.DomHelper,EMPTY_TABEL_HTML=['<table cellpadding="0" cellspacing="0">'];EMPTY_TABEL_HTML.push("<tbody></tbody></table>"),EMPTY_TABEL_HTML=EMPTY_TABEL_HTML.join("");var Row=function(record,rowIndex,grid){var me=this;me.record=record,me.rowIndex=rowIndex,me.grid=grid,me.cells=[],me.events={}};(Row.prototype={addListener:function(eventName,handler,scope){if(eventName&&isF(handler)){var me=this,en=me.events[eventName];en||(en=new Cmp.util.EventProxy,me.events[eventName]=en,me.rendered&&me.el.on(eventName,me.onEvent,me)),en.addListener(handler,scope)}},removeListener:function(eventName,handler,scope){if(eventName&&isF(handler)){var en=this.events[eventName];en&&en.removeListener(handler,scope)}},getHeight:function(){var me=this;return me.el?me.el.getHeight():0},setWidth:function(w){var me=this;me.el&&me.el.setWidth(w)},getId:function(){var me=this;return me.id||(me.id="Row-"+me.rowIndex),me.id},render:function(box){var row,bd,tr,td,inner,me=this,g=me.grid,cm=g.getColumnModel(),sm=g.getSelectionModel(),cls=["c-grid-row"];if(!me.rendered){me.rendered=!0,isF(g.getRowClass)&&(row=g.getRowClass(me.record,me.rowIndex),isA(row)?cls=cls.concat(row):isS(row)&&cls.push(row)),row=box.createChild({cls:cls,html:EMPTY_TABEL_HTML}),me.el=row,bd=row.dom.firstChild.firstChild,tr=DH.createDom({tag:"tr",parentNode:bd});for(var c,i=0,len=cm.getCount();i<len;i++)td=DH.createDom({tag:"td",parentNode:tr}),inner=Cmp.get(DH.createDom({tag:"div",parentNode:td,cls:"c-grid-cell"})),me.cells.push({el:inner,rowIndex:me.rowIndex,colIndex:i}),c=(c=cm.getColumn(i)).renderCell(inner,me.record,row,me.rowIndex,i,g.data),sm&&sm.bindCellEvent(inner,c,me.record,me.rowIndex,i);sm&&sm.bindRowEvent(me)}},remove:function(){var i,len,me=this,sm=me.grid.getSelectionModel(),cs=me.cells;if(sm){for(i=0,len=cs.length;i<len;i++)c=cs[i],sm.releaseCellEvent(c.el,c.rowIndex,c.colIndex);sm.releaseRowEvent(me)}cs=me.events;for(i in cs)c=cs[i],me.el.un(i,me.onEvent,me),c.destory();me.el.remove()},onEvent:function(ev){var me=this,type=ev.type,en=me.events[type];en&&en.fire(ev,me)}}).on=Row.prototype.addListener,Row.prototype.un=Row.prototype.removeListener,Cmp.define("Cmp.grid.Row",{factory:function(){return Row}})}(),function(){var UV=Cmp.util.ValueHelper;Cmp.define("Cmp.grid.RowModel",{requires:["Cmp.grid.Row"],factory:function(ext,reqs){var rowClass=reqs[0],RowModel=function(grid){var me=this;me.grid=grid,me.rows={}};return RowModel.prototype={getRowsHeight:function(){var h,i,me=this;if(1>me.getCount())return 0;h=0;for(i in me.rows)h+=me.rows[i].getHeight();return h},getCount:function(){return this.count},getRows:function(){var i,rows=this.rows,rs=[];for(i in rows)rs.push(rows[i]);return rs.sort(function(r1,r2){return UV.toInteger(r1.rowIndex,-1)-UV.toInteger(r2.rowIndex,-1)}),rs},clearRows:function(){var i,me=this,rows=me.rows;for(i in rows)rows[i].remove();me.rows={},me.count=0},renderRows:function(box,records){var r,me=this,i=0,len=records.length||0;for(me.clearRows();i<len;i++)r=me.renderRow(box,records[i],i),me.rows[r.getId()]=r;me.count=len},setRowWidth:function(w){var i,rs=this.rows;for(i in rs)rs[i].setWidth(w)},renderRow:function(box,record,rowIndex){var row=new rowClass(record,rowIndex,this.grid);return row.render(box),row}},RowModel}})}(),Cmp.define("Cmp.grid.GridPanel",{extend:"Cmp.Widget",requires:["Cmp.grid.GridView","Cmp.grid.RowSelectionModel","Cmp.grid.ColumnModel","Cmp.grid.RowModel"],cls:!0,factory:function(ext,reqs){var superClass=ext.prototype,viewClass=reqs[0],selModelClass=reqs[1],colModelClass=reqs[2],rowModelClass=reqs[3];return Cmp.extend(ext,{getView:function(){var me=this;return me.view||(me.view=new viewClass),me.view},getSelectionModel:function(){return this.selModel},initComponent:function(){var me=this;superClass.initComponent.call(me);var cls=["c-grid"];isS(me.cls)?cls.push(me.cls):isA(me.cls)&&(cls=cls.concat(me.cls)),me.cls=cls,me.getColumnModel(),me.getRowModel(),me.sm||me.selModel?(me.selModel=me.selModel||me.sm,isO(me.selModel)?isF(me.selModel.setSelections)||(me.selModel=new selModelClass(me.selModel)):me.selModel=new selModelClass):me.selModel=new selModelClass({noselect:!0})},getColumnModel:function(){var me=this;return me.columnModel||(me.columnModel=new colModelClass(me.columns)),me.columnModel},getRowModel:function(){var me=this;return me.rowModel||(me.rowModel=new rowModelClass(me)),me.rowModel},doRender:function(){var me=this;superClass.doRender.call(me),me.getView().render(me)}})}}),function(){var Layout=function(cfg){var me=this;isO(cfg)&&Cmp.apply(me,cfg)};Layout.prototype={getItemAt:function(index){var o=this.items[index];return o?o.cmp:void 0},getItemCount:function(){var me=this;return isA(me.items)?me.items.length:0},layout:function(contaner){var me=this,box=contaner.getLayoutTarget();if(!me.contaner){me.contaner=contaner,me.items=[],me.beforeLayout(box);for(var items=contaner.items,i=0,len=isA(items)?items.length:0;i<len;i++)me.renderItem(items[i],box,i)}},relayout:function(){},appendItem:function(item){},removeItem:function(index){var me=this,it=me.getItemAt(index);return!!it&&(me.items.splice(index,1),it.cmp.destroy(),it.el.remove(),!0)},beforeLayout:Cmp.emptyFn,renderItem:function(item,box,index){var me=this,el=box.createChild({cls:"c-ly-item"});me.items[index]={el:el},isO(item)?isF(item.render)?(item.render(me.items[index].el),me.items[index].cmp=item):Cmp.create(item,function(cmp){isO(cmp)&&isF(cmp.render)?(cmp.render(me.items[index].el),me.items[index].cmp=cmp):me.items[index].el.setStyle("display","none")}):me.items[index].el.setStyle("display","none")}},Cmp.define("Cmp.layout.Layout",{factory:function(ext,reqs){return Layout}})}(),Cmp.define("Cmp.layout.FormLayout",{extend:"Cmp.layout.Layout",cls:!0,factory:function(ext,reqs){ext.prototype;return Cmp.extend(ext,{beforeLayout:function(box){box.addClass("c-formlayout")}})}}),function(){var HTML_TMP,seq=1e4,buildId=function(){return"tv-"+ ++seq},html=[];html.push('<div class="c-treenode-warp">'),html.push('<div class="c-treenode-trigger"><span class="arrow"></span><span class="node"></span></div>'),html.push('<div class="c-treenode-inner">'),html.push('<div class="c-treenode-body"><span class="icon"></span><span class="text"></span></div>'),html.push("</div></div>"),HTML_TMP=html.join(""),TreeNodeView=function(node){var me=this;me.node=node,me.id=buildId()},TreeNodeView.prototype={getId:function(){return this.id},isExtended:function(){return!!this.extended},collend:function(){var me=this;me.isExtended()&&(me.itemBox.removeClass("c-treenode-extended"),me.childrenBox.hide(),me.extended=!1)},extend:function(){var me=this;me.isExtended()||(me.itemBox.addClass("c-treenode-extended"),me.childrenBox.show(),me.extended=!0)},isSelected:function(){return!!this.selected},select:function(){var me=this;me.isSelected()||(me.itemBox.addClass("c-treenode-selected"),me.selected=!0)},unselect:function(){var me=this;me.isSelected()&&(me.itemBox.removeClass("c-treenode-selected"),me.selected=!1)},showLoding:function(){var me=this,oldCls=me.nodeIconBox.dom.className;me.nodeIconBox.dom.className="fa fa-spinner fa-pulse",me.nodeIconBox.oldCls=oldCls},hideLoading:function(){var me=this;me.nodeIconBox.dom.className=me.nodeIconBox.oldCls,delete me.nodeIconBox.oldCls},getChildrenBox:function(){var me=this;return me.childrenBox||(me.childrenBox=me.el.createChild({cls:"c-treenode-childbox"}),me.childrenBox.setHideModal("display"),me.childrenBox.hide()),me.childrenBox},clearChilden:function(){for(var me=this,vs=me.childViews,i=0,len=isA(vs)?vs.length:0;i<len;i++)vs[i].remove();me.childViews=void 0},remove:function(){var me=this;me.clearChilden(),delete me.node,me.el.remove()},addChild:function(view){var me=this;isA(me.childViews)||(me.childViews=[]),me.childViews.push(view)},isRenderedForChildren:function(){return!!this.childrenBox},render:function(box,view){var v,dom,subDom,cns,me=this,n=me.node,lv=n.getTreeLayer();me.el=box.createChild({cls:"c-treenode"}),me.itemBox=me.el.createChild({cls:"c-treenode-item",html:HTML_TMP}),lv>0&&me.itemBox.setStyle("paddingLeft",.8*lv+"rem"),dom=me.itemBox.dom.firstChild,me.nodeIconBox=Cmp.get(dom.firstChild.childNodes[1]),cns=dom.childNodes[1].firstChild.childNodes,me.iconBox=Cmp.get(cns[0]),me.textBox=Cmp.get(cns[1]),v=n.getIcon(),(v=isS(v)?["icon",v]:!!isA(v)&&v.unshift("icon"))?(me.iconBox.setClass(v),me.itemBox.removeClass("c-treenode-noicon")):(me.iconBox.setClass("icon"),me.itemBox.addClass("c-treenode-noicon")),me.textBox.update(n.getText()||""),n.isLeaf()?me.itemBox.addClass("c-treenode-leaf"):(me.itemBox.addClass(["c-treenode-folder"]),subDom=dom.firstChild.firstChild,me.arrowBox=Cmp.get(subDom),me.arrowBox.on("click",function(ev){ev.stopPropagation(),view.onClickArrow(n)})),me.itemBox.on("click",function(ev){ev.stopPropagation(),view.onClickNode(n)}),me.itemBox.on("dblclick",function(ev){ev.stopPropagation(),view.onDbClickNode(n)})}},Cmp.define("Cmp.tree.TreeNodeView",{factory:function(){return TreeNodeView}})}(),function(){var TreeNode=function(cfg){var _tree,me=this,id=(cfg=cfg||{}).id||buildId(),leaf=!!cfg.leaf,async=!!cfg.async,alwaysReload=!!cfg.alwaysReload;if(!async){for(var c,cns=[],cs=cfg.children,i=0,len=isA(cs)?cs.length:0;i<len;i++)c=new TreeNode(cs[i]),cns.push(c),c.parent=me;me.childNodes=cns}me.data={id:id},Cmp.apply(me.data,cfg),delete me.data.leaf,delete me.data.async,delete me.data.children,delete me.data.alwaysReload,me.getId=function(){return id},me.isAsync=function(){return async},me.isAlwaysReload=function(){return async&&alwaysReload},me.isLeaf=function(){return leaf},me.bindTree=function(tree){_tree=tree},me.getTree=function(){return _tree}};TreeNode.prototype={getIcon:function(){return this.data.icon},setIcon:function(icon){},getText:function(){return this.data.text},setText:function(text){var me=this,t=me.getTree();t?(me.editing?me.editCache.text=text:me.data.text=text,t.updateNodeView(me)):me.data.text=text},getParent:function(){return this.parent},getTreeLayer:function(){var me=this;if(isN(me.treeLayer))return me.treeLayer;var p=me.getParent();return me.treeLayer=p?p.getTreeLayer()+1:0,me.treeLayer},getChildren:function(cb,scope){var me=this;if(me.isLeaf())Cmp.invoke(cb,scope,[]);else if(me.isAsync()){if(!isA(me.childNodes)||me.isAlwaysReload()){var loader=me.getTree();if(loader&&(loader=loader.getLoader())&&isF(loader.load))return void loader.load(me,function(os){for(var c,i=0,len=isA(os)?os.length:0,cns=[];i<len;i++)(c=new TreeNode(os[i])).parent=me,cns.push(c);me.childNodes=cns,Cmp.invoke(cb,scope,[cns])});Cmp.invoke(cb,scope,[])}}else Cmp.invoke(cb,scope,[me.childNodes])},startEdit:function(){},submitEdit:function(){},endEdit:function(){}},Cmp.define("Cmp.tree.TreeNode",{factory:function(){return TreeNode}})}(),Cmp.define("Cmp.tree.TreeView",{requires:["Cmp.tree.TreeNode","Cmp.tree.TreeNodeView"],factory:function(ext,reqs){var nodeClazz=reqs[0],nodeViewClazz=reqs[1],TreeView=function(){var me=this;me.nodeViews={},me.delayClick=!1,me.finishDaleyByClick=function(){me.delayClick=!1},me.clickDaley=new Cmp.util.DelayedTask({delay:500,handler:me.finishDaleyByClick,scope:me})};return TreeView.prototype={render:function(tree,target){var me=this;if(!me.tree){me.tree=tree,me.treeBox=target,tree.useArrow&&target.addClass("c-tree-usrarrow"),me.mask=target.createChild({cls:"c-tree-mask"}),me.mask.setHideModal("display"),me.mask.hide();var rootView=me.renderTreeNode(tree.root,me.treeBox);tree.hidderRoot&&(rootView.node.treeLayer=-1,rootView.itemBox.setStyle("display","none"),me.doExtendNode(rootView))}},renderTreeNode:function(node,box){var me=this;if(isO(node)){isF(node.getId)||(node=new nodeClazz(node)),node.bindTree(me.tree);var view=me.createTreeNodeView(node);return view.render(box,me),me.nodeViews[node.getId()]=view,view}},createTreeNodeView:function(node){return new nodeViewClazz(node)},getNodeView:function(node){var me=this;if(isO(node)&&(node=isF(node.getId)?node.getId():node.id),isS(node))return me.nodeViews[node]},onClickArrow:function(node){var me=this,v=me.getNodeView(node);v&&(v.isExtended()?me.doCollectNode(v):me.doExtendNode(v))},onClickNode:function(node){var me=this,v=me.getNodeView(node);if(v&&!me.delayClick){me.delayClick=!0;var acv=me.activedView;acv&&acv.unselect(),acv&&acv.getId()===v.getId()?me.activedView=void 0:(v.select(),me.activedView=v),me.tree.fireEvent("selectedchange",me.activedView?me.activedView.node:void 0,me.tree),me.clickDaley.run()}},onDbClickNode:function(node){var me=this,v=me.getNodeView(node);v&&me.tree.fireEvent("dblclicknode",v.node,me.tree)},doExtendNode:function(nodeView,cb,scope){var me=this,node=nodeView.node;!nodeView.isRenderedForChildren()||node.isAlwaysReload()?(me.mask.show(),nodeView.showLoding(),node.getChildren(function(cns){me.mask.hide(),nodeView.hideLoading();var cn,box=nodeView.getChildrenBox(),i=0,len=isA(cns)?cns.length:0;if(nodeView.clearChilden(),len>0)for(;i<len;i++)(cn=me.renderTreeNode(cns[i],box))&&nodeView.addChild(cn);else(cn=me.renderEmptyChild(box,node.getTreeLayer()))&&nodeView.addChild(cn);nodeView.extend(),me.tree.fireEvent("extendednode",node,me.tree),isF(cb)&&cb.call(scope)})):(nodeView.extend(),me.tree.fireEvent("extendednode",node,me.tree),isF(cb)&&cb.call(scope))},doCollectNode:function(nodeView){var me=this;nodeView.collend(),me.tree.fireEvent("collectednode",nodeView.node,me.tree)},renderEmptyChild:function(box,lv){s=.8*(lv+2)+"rem",box.createChild({cls:"c-treenode c-treenode-empty",html:'<div class="c-treenode-item" style="padding-left:'+s+';"><div class="c-treenode-warp">空</div></div>'})}},TreeView}}),function(){var extendNodes=function(tree,nodes){for(var v,view=tree.getView(),i=0,len=nodes.length;i<len;i++)if((v=view.getNodeView(nodes[i]))&&!v.isExtended())return void view.doExtendNode(v,function(){extendNodes(tree,nodes)})};Cmp.define("Cmp.tree.TreePanel",{extend:"Cmp.Widget",requires:["Cmp.tree.TreeView"],cls:!0,factory:function(ext,reqs){var superClazz=ext.prototype,treeViewClazz=reqs[0];return Cmp.extend(ext,{getLoader:function(){return this.treeLoader},updateNodeView:function(node){},initComponent:function(){var me=this,cls=me.cls;isA(cls)?cls.unshift("c-tree"):cls=isS(cls)?["c-tree",cls]:"c-tree",me.cls=cls,superClazz.initComponent.call(me),me.addEvents("dblclicknode","selectedchange","extendednode","collectednode")},getView:function(){var me=this;return me.view||(me.view=new treeViewClazz),me.view},doRender:function(){var me=this;superClazz.doRender.call(me),me.getView().render(me,me.el);var ens=isS(me.extendNode)?[me.extendNode]:me.extendNode;isA(ens)&&ens.length>0&&extendNodes(me,ens),delete me.extendNode},getSelected:function(){var v=this.getView().activedView;if(v)return v.node}})}})}(),Cmp.define("Cmp.Button",{extend:"Cmp.Widget",cls:!0,factory:function(ext,reqs){var SP=ext.prototype;return Cmp.extend(ext,{setText:function(text){var me=this;me.text=text,me.textBox&&(me.textBox.update(text||""),text?me.el.removeClass("c-btn-notext"):me.el.addClass("c-btn-notext"))},setIcon:function(icon){var me=this;me.icon&&(me.iconBox.removeClass(me.icon),icon||me.el.addClass("c-btn-noicon")),icon&&(me.iconBox.addClass(icon),me.icon||me.el.removeClass("c-btn-noicon")),me.icon=icon},active:function(){var me=this;me.actived||me.el.setAttribute("actived","actived"),me.actived=!0},unactive:function(){var me=this;me.actived&&me.el.removeAttribute("actived"),me.actived=!1},enable:function(){var me=this;me.disabled&&(me.disabled=!1,me.el&&(me.el.removeClass("c-btn-disabled"),me.el.dom.disabled=!1))},disable:function(){var me=this;me.disabled||(me.disabled=!0,me.el&&(me.el.addClass("c-btn-disabled"),me.el.dom.disabled=!0))},setTooltip:function(tooltip){var me=this;me.el?me.el.setAttribute("title",tooltip||""):me.tooltip=tooltip},initComponent:function(){var me=this;SP.initComponent.call(me),me.tagName="button";var cls=["c-btn"];isS(me.cls)?cls.push(me.cls):isA(me.cls)&&(cls=cls.concat(me.cls)),me.cls=cls},doRender:function(){var me=this;SP.doRender.call(me),me.el.setHideModal("display"),me.iconBox=me.el.createChild({tag:"i"}),me.icon?me.iconBox.addClass(me.icon):me.el.addClass("c-btn-noicon"),me.textBox=me.el.createChild({tag:"b",cls:me.textCls||void 0}),me.text?me.textBox.update(me.text):me.el.addClass("c-btn-notext"),me.tooltip&&me.el.setAttribute("title",me.tooltip),(isS(me.btnCls)||isA(me.btnCls))&&me.el.addClass(me.btnCls),me.disabled=!!me.disabled,me.disabled&&(me.el.addClass("c-btn-disabled"),me.el.dom.disabled=!0),me.actived=!!me.actived,me.actived&&me.el.setAttribute("actived",!0),me.el.on("click",me.onClickButton,me)},onClickButton:function(){var me=this;!me.disabled&&isF(me.handler)&&me.handler.call(me.scope||me,me)}})}}),Cmp.define("Cmp.Contaner",{extend:"Cmp.Widget",requires:["Cmp.layout.Layout"],factory:function(ext,reqs){var superClazz=ext.prototype,layoutClazz=reqs[0];return Cmp.extend(ext,{getItemAt:function(index){var me=this;return me.layoutReady?me.getLayout().getItemAt(index):void 0},getItemCount:function(){var me=this;return me.layoutReady?me.getLayout().getItemCount():isA(me.items)?me.items.length:0},addItem:function(item){var me=this;if(me.layoutReady)return me.getLayout().appendItem(item);isA(me.items)?me.items.push(item):isO(me.items)?me.items=[me.items,item]:me.items=[item]},removeItemAt:function(index){return this.getLayout().removeItem(index)},initComponent:function(){var me=this,ly=me.layout;superClazz.initComponent.call(me),me.layoutReady=!1,isS(ly)?Cmp.require(ly,function(clz){if(isF(clz)){var lyo=new clz(me.layoutConfig||{});isF(lyo.layout)?(me.layout=lyo,me.layoutReady=!0,me.fireLayoutReady()):(putLog("根据名称获得的布局管理器，没有实现布局方法,将使用默认的；设定的管理器名称："+JSON.stringify(ly)),me.layout=new layoutClazz(me.layoutConfig||{}),me.layoutReady=!0,me.fireLayoutReady())}else putLog("无法获取指定的布局管理器,将使用默认的；设定的管理器标识名："+ly),me.layout=new layoutClazz(me.layoutConfig||{}),me.layoutReady=!0,me.fireLayoutReady()}):isO(ly)&&(isF(ly.layout)?(me.layout=ly,me.layoutReady=!0,me.fireLayoutReady()):Cmp.create(ly,function(lyo){isF(lyo.layout)?(me.layout=lyo,me.layoutReady=!0,me.fireLayoutReady()):(putLog("无法获取指定的布局管理器,将使用默认的；设定的管理器："+JSON.stringify(ly)),me.layout=new layoutClazz(me.layoutConfig||{}),me.layoutReady=!0,me.fireLayoutReady())}))},getLayoutTarget:function(){return this.el},getLayout:function(){return this.layout},doRender:function(){var me=this;superClazz.doRender.call(me),me.layoutReady?me.doLayout():me.onReadyCreateLayout(me.doLayout,me)},doLayout:function(){var me=this;me.getLayout().layout(me)},onReadyCreateLayout:function(fn,scope){var me=this;me.layoutReady?Cmp.invoke(fn,scope):(me.readLayoutListeners||(me.readLayoutListeners=[]),me.readLayoutListeners.push({fn:fn,scope:scope}))},fireLayoutReady:function(){for(var o,me=this,i=0,len=isA(me.readLayoutListeners)?me.readLayoutListeners.length:0;i<len;i++)o=me.readLayoutListeners[i],Cmp.invoke(o.fn,o.scope)}})}}),function(){var DATALIST_BOX_HTML=[],getDaysOfMonth=function(year,month){switch(month){case 3:case 5:case 8:case 10:return 30;case 1:return 0==year%400||0!=year%100&&0==year%4?29:28;default:return 31}},buildDayRow=function(rowClss){var html=[];return html.push('<div class="c-datelist-row '),html.push(rowClss),html.push('">'),html.push('<div class="c-datelist-cell"><span class="c-datelist-cell-inner c-datelist-sun">日</span></div>'),html.push('<div class="c-datelist-cell"><span class="c-datelist-cell-inner c-datelist-mon">一</span></div>'),html.push('<div class="c-datelist-cell"><span class="c-datelist-cell-inner c-datelist-tue">二</span></div>'),html.push('<div class="c-datelist-cell"><span class="c-datelist-cell-inner c-datelist-wed">三</span></div>'),html.push('<div class="c-datelist-cell"><span class="c-datelist-cell-inner c-datelist-thu">四</span></div>'),html.push('<div class="c-datelist-cell"><span class="c-datelist-cell-inner c-datelist-fri">五</span></div>'),html.push('<div class="c-datelist-cell"><span class="c-datelist-cell-inner c-datelist-sat">六</span></div>'),html.push("</div>"),html.join("")},html=[];html.push('<div class="c-datelist-head">'),html.push('<div class="c-datelist-head-left">'),html.push('<div class="c-datelist-headbtn fa fa-fast-backward" title="上一年"></div>'),html.push('<div class="c-datelist-headbtn fa fa-step-backward" title="上一月"></div>'),html.push("</div>"),html.push('<div class="c-datelist-head-center"></div>'),html.push('<div class="c-datelist-head-right">'),html.push('<div class="c-datelist-headbtn fa fa-fast-forward" title="下一年"></div>'),html.push('<div class="c-datelist-headbtn fa fa-step-forward" title="下一月"></div>'),html.push("</div></div>"),html.push('<div class="c-datelist-body">'),html.push(buildDayRow("c-datelist-week"));for(var i=0;i<6;i++)html.push(buildDayRow("c-datelist-day"));html.push("</div>"),DATALIST_BOX_HTML=html.join("");var DayButtom=function(dom,handler,scope){var me=this;me.el=Cmp.get(dom),me.textEl=Cmp.get(dom.firstChild),me.disabled=!1,me.selected=!1,me.currentMonth=!0,me.handler=handler,me.scope=scope,me.el.on("click",me.onClick,me)};DayButtom.prototype={setValue:function(day,noCurrentMonth,nowDay){var me=this,t=day[2];t<10&&(t="0"+t),me.textEl.update(t),me.value=day,noCurrentMonth&&!0===me.currentMonth?(me.el.addClass("c-datelist-nocurrent"),me.currentMonth=!1):noCurrentMonth||!1!==me.currentMonth||(me.el.removeClass("c-datelist-nocurrent"),me.currentMonth=!0),day[0]===nowDay[0]&&day[1]===nowDay[1]&&day[2]===nowDay[2]?me.el.addClass("c-datelist-today"):me.el.removeClass("c-datelist-today")},isSelected:function(){return!!this.selected},select:function(){var me=this;me.isSelected()||(me.el.addClass("c-datelist-selected"),me.selected=!0)},unselect:function(){var me=this;me.isSelected()&&(me.el.removeClass("c-datelist-selected"),me.selected=!1)},isDisabled:function(){return!!this.disabled},disable:function(){var me=this;me.isDisabled()||(me.el.addClass("c-datelist-btn-disabled"),me.el.setAttribute("disabled",!0),me.disabled=!0)},enable:function(){var me=this;me.isDisabled()&&(me.el.removeClass("c-datelist-btn-disabled"),me.el.removeAttribute("disabled"),me.disabled=!1)},onClick:function(){var me=this;!me.isDisabled()&&isF(me.handler)&&me.handler.call(me.scope,me.value,me)}};var compareOfDay=function(d1,d2){for(var v,i=0;i<3;i++)if(0!=(v=d1[i]-d2[i]))return v;return 0},buildBtnObject=function(dom,handler,value){var me=this,rel={el:Cmp.get(dom),disabled:!1,handler:handler,scope:me,value:value};return rel.el.on("click",function(){!1===rel.disabled&&rel.handler.call(rel.scope||me,rel.value)}),rel.disable=function(){!1===rel.disabled&&(rel.el.addClass("c-datelist-headbtn-disabled"),rel.disabled=!0)},rel.enable=function(){!0===rel.disabled&&(rel.el.removeClass("c-datelist-headbtn-disabled"),rel.disabled=!1)},rel},buildDayBtn=function(dom){var me=this;return new DayButtom(dom,me.onClickDayBtn,me)},refreshCmps=function(year,month){var me=this,cmps=me.cmps,dayBtns=cmps.dayBtns,minDay=[me.minYear,me.minMonth,me.minDay],maxDay=[me.maxYear,me.maxMonth,me.maxDay],nowDay=new Date;nowDay=[nowDay.getFullYear(),nowDay.getMonth(),nowDay.getDate()];var setSelectedStatus=function(btn,dv){if(me.value){var y=me.value.getFullYear(),m=me.value.getMonth(),d=me.value.getDate();dv[0]===y&&dv[1]===m&&dv[2]===d?btn.select():btn.unselect()}else btn.unselect()},setDisabledStatus=function(btn,dv){dv[0],dv[1],dv[2];compareOfDay(minDay,dv)<1&&compareOfDay(maxDay,dv)>-1?btn.enable():btn.disable()};me.minYear===year?(cmps.forwardYearBtn.disable(),me.minMonth>=month?cmps.forwardMonthBtn.disable():cmps.forwardMonthBtn.enable()):me.minYear>year?(cmps.forwardYearBtn.disable(),cmps.forwardMonthBtn.disable()):(cmps.forwardYearBtn.enable(),cmps.forwardMonthBtn.enable()),me.maxYear>year?(cmps.nextYearBtn.enable(),cmps.nextMonthBtn.enable()):me.maxYear===year?(cmps.nextYearBtn.disable(),me.maxMonth<=month?cmps.nextMonthBtn.disable():cmps.nextMonthBtn.enable()):(cmps.nextYearBtn.disable(),cmps.nextMonthBtn.disable()),cmps.currentMonthBox.update(year+"年,"+(month+1)+"月");var ly,lm,startDay,mds,ix,i,len,di,d,dayOfWeek=new Date(year,month,1).getDay();for(dayOfWeek=0==dayOfWeek?7:dayOfWeek,month>0?(ly=year,lm=month-1):(ly=year-1,lm=11),startDay=(mds=getDaysOfMonth(ly,lm))-dayOfWeek,i=0,len=dayOfWeek;i<len;i++)d=[ly,lm,startDay+1+i],(di=dayBtns[i]).setValue(d,!0,nowDay),setSelectedStatus(di,d),setDisabledStatus(di,d);for(i=0,len=mds=getDaysOfMonth(year,month);i<len;i++)d=[year,month,i+1],(di=dayBtns[ix=dayOfWeek+i]).setValue(d,!1,nowDay),setSelectedStatus(di,d),setDisabledStatus(di,d);if(11==month?(ly=year+1,lm=0):(ly=year,lm=month+1),len=mds+dayOfWeek,dayBtns.length>len)for(i=len,len=dayBtns.length,ix=1;i<len;i++,ix++)d=[ly,lm,ix],(di=dayBtns[i]).setValue(d,!0,nowDay),setSelectedStatus(di,d),setDisabledStatus(di,d)};Cmp.define("Cmp.DateList",{extend:"Cmp.Widget",cls:!0,factory:function(ext,reqs){var superClazz=ext.prototype;return Cmp.extend(ext,{setValue:function(date,refresh){var me=this;if((me.value!==date||refresh)&&(me.value=date,me.cmps)){var y,m;isD(date)?(y=date.getFullYear(),m=date.getMonth()):(y=(date=new Date).getFullYear(),m=date.getMonth()),me.currentYear=y,me.currentMonth=m,refreshCmps.call(me,y,m)}},setValueRange:function(min,max){var v,me=this;isD(min)&&isD(max)&&min.getTime()>max.getTime()&&(v=min,min=max,max=v),isD(min)?(me.minYear=min.getFullYear(),me.minMonth=min.getMonth(),me.minDay=min.getDate()):(me.minYear=1970,me.minMonth=0,me.minDay=1),isD(max)?(me.maxYear=max.getFullYear(),me.maxMonth=max.getMonth(),me.maxDay=max.getDate()):(me.maxYear=2099,me.maxMonth=11,me.maxDay=31)},initComponent:function(){var me=this,v=me.cls;isA(v)?v.unshift("c-datelist"):v=isS(v)?["c-datelist",v]:"c-datelist",me.cls=v,superClazz.initComponent.call(me),me.setValueRange(me.minValue,me.maxValue),delete me.minValue,delete me.maxValue,me.addEvents("clickday","selectedchanged")},doRender:function(){var subDoms,el,me=this,cmps={};superClazz.doRender.call(me),el=me.el.createChild({cls:"c-datelist-box",html:DATALIST_BOX_HTML}),me.el.createChild({cls:"c-datelist-arrow"}),subDoms=el.dom.firstChild.childNodes,cmps.forwardYearBtn=buildBtnObject.call(me,subDoms[0].firstChild,me.onClickForwardYear),cmps.forwardMonthBtn=buildBtnObject.call(me,subDoms[0].childNodes[1],me.onClickForwardMonth),cmps.currentMonthBox=Cmp.get(subDoms[1]),cmps.nextYearBtn=buildBtnObject.call(me,subDoms[2].firstChild,me.onClickNextYear),cmps.nextMonthBtn=buildBtnObject.call(me,subDoms[2].childNodes[1],me.onClickNextMonth),subDoms=el.dom.childNodes[1].childNodes;for(var j,sd,i=1,dayBtns=[];i<7;i++)for(sd=subDoms[i].childNodes,j=0;j<7;j++)dayBtns.push(buildDayBtn.call(me,sd[j]));cmps.dayBtns=dayBtns,me.cmps=cmps;var v=me.value;me.value=!1,me.setValue(v)},onClickForwardYear:function(){var me=this,y=me.currentYear-1,m=me.currentMonth;me.minYear===y&&me.minMonth>m&&(m=me.minMonth),me.currentYear=y,me.currentMonth=m,refreshCmps.call(me,y,m)},onClickForwardMonth:function(){var y,m,me=this;0===me.currentMonth?(m=11,y=me.currentYear-1):(m=me.currentMonth-1,y=me.currentYear),me.currentYear=y,me.currentMonth=m,refreshCmps.call(me,y,m)},onClickNextYear:function(){var me=this,y=me.currentYear+1,m=me.currentMonth;me.maxYear===y&&me.maxMonth<m&&(m=me.maxMonth),me.currentYear=y,me.currentMonth=m,refreshCmps.call(me,y,m)},onClickNextMonth:function(){var y,m,me=this;11===me.currentMonth?(m=0,y=me.currentYear+1):(m=me.currentMonth+1,y=me.currentYear),me.currentYear=y,me.currentMonth=m,refreshCmps.call(me,y,m)},doChangeValue:function(day){var me=this,y=day[0],m=day[1];d=new Date(y,m,day[2]),!1!==me.fireEvent("clickday",d,me)&&(me.value&&me.value.getFullYear()===y&&me.value.getMonth()===m&&me.value.getDate()===day[2]||(me.value=d,refreshCmps.call(me,y,m),me.fireEvent("selectedchanged",d)))},onClickDayBtn:function(day,btn){var me=this,y=day[0],m=day[1];y===me.currentYear&&m===me.currentMonth?me.doChangeValue(day):y===me.currentYear?m>me.currentMonth?me.onClickNextMonth():me.onClickForwardMonth():y>me.currentYear?me.onClickNextMonth():me.onClickForwardMonth()}})}})}(),function(){var HTML_TMP=[];HTML_TMP.push('<div class="c-dlg-box">'),HTML_TMP.push('<div class="c-dlg-top"><div class="c-dlg-title">请稍等</div></div>'),HTML_TMP.push('<div class="c-dlg-center"><div class="c-dlg-center-inner"></div></div>'),HTML_TMP.push('<div class="c-dlg-bottom"><div class="c-dlg-bottom-inner"></div></div>'),HTML_TMP.push("</div>"),HTML_TMP=HTML_TMP.join("");var BTNS_CONFIG={ok:{text:"确定"},cancel:{text:"取消"}};Cmp.define("Cmp.Dialog",{extend:"Cmp.Widget",requires:["Cmp.Button"],cls:!0,factory:function(ext,reqs){var superClass=ext.prototype,btnClz=reqs[0];return Cmp.extend(ext,{updateBody:function(bodyHtml,dlgCls){var subDoms,me=this;if((subDoms=me.body.dom.childNodes)&&subDoms.length>0)for(;subDoms.length>0;)Cmp.get(subDoms[subDoms.length-1]).remove();me.definedCls&&me.el.removeClass(me.definedCls),me.body.update(bodyHtml),me.el.addClass(dlgCls),me.definedCls=dlgCls},showBoth:function(title,btns){var me=this;me.showTitle(title),me.showBottom(btns)},hideBoth:function(){var me=this;me.hideTitle(),me.hideBottom()},hideTitle:function(){var me=this;me.hiddenTitie||(me.hiddenTitie=!0,me.el.addClass("c-dlg-notop"))},showTitle:function(title){var me=this;me.hiddenTitie&&(me.hiddenTitie=!1,me.el.removeClass("c-dlg-notop")),me.titleBox.update(title||"")},showBottom:function(btns){var i,len,o,btn,cfg,me=this;me.hiddenBottom&&(me.hiddenBottom=!1,me.el.removeClass("c-dlg-nobottom"));for(i in me.bottons)(btn=me.bottons[i]).hide();if(isA(btns)&&btns.length>0)for(i=0,len=btns.length;i<len;i++)o=btns[i],(btn=me.bottons[o.id])&&(cfg=BTNS_CONFIG[o.id],isS(o.text)?btn.setText(o.text):btn.setText(cfg.text),isF(o.handler)?btn.handler=o.handler.createDelegate(o.scope,[o.id]):btn.handler=void 0,btn.show())},hideBottom:function(){var me=this;me.hiddenBottom||(me.hiddenBottom=!0,me.el.addClass("c-dlg-nobottom"))},initComponent:function(){var me=this;superClass.initComponent.call(me);var cls=["c-dlg"];isS(me.cls)?cls.push(me.cls):isA(me.cls)&&(cls=cls.concat(me.cls)),me.cls=cls},doRender:function(){var dom,subDom,me=this;superClass.doRender.call(me),me.el.setHideModal("display"),me.el.update(HTML_TMP),subDom=(dom=me.el.dom.firstChild).childNodes[0].firstChild,me.titleBox=Cmp.get(subDom),subDom=dom.childNodes[1].firstChild,me.body=Cmp.get(subDom),subDom=dom.childNodes[2].firstChild,me.buttonBox=Cmp.get(subDom);var btns={};btns.ok=new btnClz({cls:"c-btn-ok",text:"确定"}),btns.ok.render(me.buttonBox),btns.ok.el.setHideModal("display"),btns.cancel=new btnClz({cls:"c-btn-cancel",text:"取消"}),btns.cancel.render(me.buttonBox),btns.cancel.el.setHideModal("display"),me.bottons=btns},show:function(){var me=this;superClass.show.call(me),me.getBodyMask().show()},hide:function(){var me=this;superClass.hide.call(me),me.getBodyMask().hide()},getBodyMask:function(){var me=this;return me.bodyMask||(me.bodyMask=Cmp.getBody().createMask("DialogMask",9e5),me.bodyMask.addClass("c-dlg-mask")),me.bodyMask}})}})}(),function(){var dlg,biuldWaitHtml=function(msg){var html=[];return html.push('<div class="c-dlgs-icon"></div>'),html.push('<div class="c-dlgs-msgbox"><div class="c-dlgs-msgbox-inner">'),html.push(msg),html.push("</div></div>"),html.join("")},Rel={hide:function(){dlg&&dlg.hide()},showWait:function(msg){dlg&&(dlg.hideBoth(),dlg.updateBody(biuldWaitHtml(msg),"c-dlgs-wait"),dlg.show())},showWarn:function(msg,title){dlg&&(dlg.showBoth(title||"",[{id:"ok",text:"关闭",handler:function(){dlg.hide()}}]),dlg.updateBody(biuldWaitHtml(msg),"c-dlgs-warn"),dlg.show())},showSuccess:function(msg,title,callback,scope){dlg&&(dlg.showBoth(title||"",[{id:"ok",text:"确认",handler:function(){dlg.hide(),Cmp.invoke(callback,scope)}}]),dlg.updateBody(biuldWaitHtml(msg),"c-dlgs-success"),dlg.show())},showSuccessForOkcanel:function(msg,title,callback,scope){dlg&&(dlg.showBoth(title||"",[{id:"ok",text:"确定",handler:function(){dlg.hide(),Cmp.invoke(callback,scope,[!0])}},{id:"cancel",text:"取消",handler:function(btn){dlg.hide(),Cmp.invoke(callback,scope,[!1])}}]),dlg.updateBody(biuldWaitHtml(msg),"c-dlgs-success"),dlg.show())},showSuccessForYesNo:function(msg,title,callback,scope,btns){dlg&&(dlg.showBoth(title||"",[{id:"ok",text:btns?btns.ok||"是":"是",handler:function(){dlg.hide(),Cmp.invoke(callback,scope,[!0])}},{id:"cancel",text:btns?btns.cancel||"否":"否",handler:function(btn){dlg.hide(),Cmp.invoke(callback,scope,[!1])}}]),dlg.updateBody(biuldWaitHtml(msg),"c-dlgs-success"),dlg.show())},showConfirm:function(msg,title,callback,scope){dlg&&(dlg.updateBody(biuldWaitHtml(msg),"c-dlgs-confirm"),dlg.showBoth(title||"",[{id:"ok",text:"确定",handler:function(btn){dlg.hide(),Cmp.invoke(callback,scope,[!0])}},{id:"cancel",text:"取消",handler:function(btn){dlg.hide(),Cmp.invoke(callback,scope,[!1])}}]),dlg.show())}};Cmp.define("Cmp.Dialogs",{requires:["Cmp.Dialog"],cls:!0,factory:function(ext,reqs){return(dlg=new reqs[0]).render(Cmp.getBody()),dlg.hide(),Rel}})}(),function(){var HTML_TMP,html,UV=Cmp.util.ValueHelper,NUMBER_CODE=[48,49,50,51,52,53,54,55,56,57];(html=[]).push('<div class="c-pgbar-btns">'),html.push("</div>"),html.push('<div class="c-pgbar-msg">共xxx页</div>'),html.push('<div class="c-pgbar-jump">'),html.push('<span class="text">到</span><input type="text"></input><span class="text">页</span>'),html.push('<button class="c-btn c-pgbar-jumpbtn">确定</button>'),html.push("</div>"),html.push('<div class="c-pgbar-ops">'),html.push("</div>"),HTML_TMP=html.join(""),(html=[]).push('<div class="c-pgbar-btns">'),html.push("</div>"),html.push('<div class="c-pgbar-jump">'),html.push('<span class="text">到</span><input type="text"></input><span class="text">/xxx页</span>'),html.push("</div>"),html.join("");var getDiForNumber=function(v){if(v<10)return 1;if(v<100)return 2;if(v<1e3)return 3;if(v<1e4)return 4;for(var s=0,t=v;t>0;)s++,t=Math.floor(t/10);return s},updateBtnStyle=function(btn,isShow,text,pageIndex,actived,icon){!1!==isShow?(btn.show(),btn.setText(text),void 0!==icon&&btn.setIcon(icon),actived?btn.active():btn.unactive(),btn.pageIndex=pageIndex):btn.hide()},createButtonHandler=function(dom,handler,value){var rel,me=this;return rel={value:value,actived:!1,disabled:!1,el:Cmp.get(dom)},rel.getValue=function(){return rel.value},rel.setValue=function(v){rel.value=v},rel.setText=function(tx){rel.el.update(tx||"")},rel.active=function(){rel.actived||rel.el.setAttribute("actived",!0),rel.actived=!0},rel.unactive=function(){rel.actived&&rel.el.removeAttribute("actived"),rel.actived=!1},rel.enable=function(){rel.disabled&&(rel.disabled=!1,rel.el&&(rel.el.removeClass("c-btn-disabled"),rel.el.dom.disabled=!1))},rel.disable=function(){rel.disabled||(rel.disabled=!0,rel.el&&(rel.el.addClass("c-btn-disabled"),rel.el.dom.disabled=!0))},rel.hide=function(){rel.el.hide()},rel.show=function(){rel.el.show()},rel.el.setHideModal("display"),rel.el.on("click",function(){handler.call(me,rel)}),rel},refreshByStandardWithInrange=function(pageIndex,pageTotal){var btn,me=this,btns=me.pageBtns,pix=pageIndex+1,pi=2,length=btns.length,i=0,len=length<pageTotal?length:pageTotal-1;for((btn=btns[length-1]).el.removeClass("c-pgbar-move");i<len;i++)btn=btns[i],updateBtnStyle(btn,!0,(pi=i+2)+"",pi,pi===pix,!1);if(pageTotal<9)for(me.lastBtn.hide();i<length;i++)btn=btns[i],updateBtnStyle(btn,!1);else me.lastBtn.show(),me.lastBtn.setText(pageTotal),pix===pageTotal?me.lastBtn.active():me.lastBtn.unactive()},refreshByStandardWithOverflow=function(pageIndex,pageTotal){var pi,pmi,pma,i,len,btn,me=this,btns=me.pageBtns,pix=pageIndex+1,length=btns.length;if(me.lastBtn.show(),me.lastBtn.setText(pageTotal),pix===pageTotal?me.lastBtn.active():me.lastBtn.unactive(),pageIndex<5){for(btn=btns[0],updateBtnStyle(btn,!0,"2",2,2===pix,!1),btn.el.removeClass("c-pgbar-move"),i=1,len=length-1;i<len;i++)pi=i+2,btn=btns[i],updateBtnStyle(btn,!0,pi+"",pi,pi===pix);btn=btns[len],updateBtnStyle(btn,!0,"",8,!1,["fa","fa-ellipsis-h"]),btn.el.addClass("c-pgbar-move")}else if(pageIndex>pageTotal-5){for(pmi=pageTotal-7,btn=btns[0],updateBtnStyle(btn,!0,"",pmi,!1,["fa","fa-ellipsis-h"]),btn.el.addClass("c-pgbar-move"),i=1,len=length-1;i<len;i++)pi=i+pmi,btn=btns[i],updateBtnStyle(btn,!0,pi+"",pi,pi===pix);btn=btns[len],updateBtnStyle(btn,!0,(pma=pageTotal-1)+"",pma,pma===pix,!1),btn.el.removeClass("c-pgbar-move")}else{for(pmi=pageIndex-2,pma=pageIndex+2,btn=btns[0],updateBtnStyle(btn,!0,"",pmi-1,!1,["fa","fa-ellipsis-h"]),btn.el.addClass("c-pgbar-move"),i=1,len=length-1;i<len;i++)pi=i+pmi,btn=btns[i],updateBtnStyle(btn,!0,pi+"",pi,pi===pix);btn=btns[len],updateBtnStyle(btn,!0,"",pma+1,!1,["fa","fa-ellipsis-h"]),btn.el.addClass("c-pgbar-move")}},refreshByStandard=function(pageIndex,pageTotal){var i,me=this,lastPageIndex=pageTotal-1,btns=me.pageBtns,length=btns.length;if(pageIndex>0?me.backwardBtn.enable():me.backwardBtn.disable(),pageIndex<lastPageIndex?me.forwardBtn.enable():me.forwardBtn.disable(),pageTotal<1)for(me.msgBox.update("无数据"),me.pageIndexInput.dom.disabled=!0,me.jumpPageBtn.disable(),me.firstBtn.hide(),me.lastBtn.hide(),i=0;i<length;i++)btns[i].hide();else me.msgBox.update("共"+pageTotal+"页"),1===pageTotal?(me.pageIndexInput.dom.disabled=!0,me.jumpPageBtn.disable()):(me.pageIndexInput.dom.disabled=!1,me.pageIndexInput.dom.maxLength=getDiForNumber(pageTotal),me.jumpPageBtn.enable()),me.firstBtn.show(),0===pageIndex?me.firstBtn.active():me.firstBtn.unactive(),pageTotal<10?refreshByStandardWithInrange.call(me,pageIndex,pageTotal):refreshByStandardWithOverflow.call(me,pageIndex,pageTotal)};Cmp.define("Cmp.PagingBar",{extend:"Cmp.Widget",requires:["Cmp.Button","Cmp.form.ComboBox","Cmp.util.KeyMap"],cls:!0,factory:function(ext,reqs){var superClazz=ext.prototype,buttonClazz=reqs[0],KeyMap=(reqs[1],reqs[2]);return Cmp.extend(ext,{setDataResult:function(rs){rs=rs||{};var me=this,ix=isN(rs.pageIndex)?rs.pageIndex:0;tl=isN(rs.pageSize)?rs.pageSize:0,refreshByStandard.call(me,ix,tl),me.pageIndex=ix,me.pageSize=tl},getPageIndex:function(){return this.pageIndex},getPageLimit:function(){return this.pageLimit},initComponent:function(){var me=this,cls=me.cls;isA(cls)?cls.unshift("c-pgbar"):cls=isS(cls)?["c-pgbar",cls]:"c-pgbar",me.cls=cls,superClazz.initComponent.call(me),me.addEvents("indexchange","limitchange"),cls=me.pageSizeOptions,isA(cls)&&0!==cls.length?cls.length>5&&(cls=cls.slice(0,5)):cls=[10,20,50],me.pageSizeOptions=cls,cls=me.pageLimit,(!isN(cls)||me.pageSizeOptions.indexOf(cls)<0)&&(cls=me.pageSizeOptions[0]),me.pageLimit=cls,me.pageSize=isN(me.pageSize)?me.pageSize:0,me.pageIndex=isN(me.pageIndex)?me.pageIndex:0},doRender:function(){var me=this;superClazz.doRender.call(me),me.doRenderByStandard(),refreshByStandard.call(me,me.pageIndex,me.pageSize)},doRenderByStandard:function(){var dom,cns,btn,me=this,btns=[];for(dom=me.el.createChild({cls:"c-pgbar-box",html:HTML_TMP}).dom,me.btnBox=Cmp.get(dom.firstChild),me.backwardBtn=me.appendBtn("forward",void 0,"c-pgbar-arrow",["fa","fa-chevron-left"],me.onBackwardPage),me.firstBtn=me.appendBtn("first","1",void 0,void 0,me.onFirstPage),i=0;i<7;i++)k="btn-"+i,6!=i?btns.push(me.appendBtn(k,2+i+"",void 0,void 0,me.onPageIndex)):btns.push(me.appendBtn(k,void 0,"c-pgbar-move",["fa","fa-ellipsis-h"],me.onPageIndex));me.lastBtn=me.appendBtn("last","Max",void 0,void 0,me.onLastPage),me.forwardBtn=me.appendBtn("backward",void 0,"c-pgbar-arrow",["fa","fa-chevron-right"],me.onForwardPage),me.pageBtns=btns,me.msgBox=Cmp.get(dom.childNodes[1]),cns=dom.childNodes[2].childNodes,me.pageIndexInput=Cmp.get(cns[1]),me.keyMap=new KeyMap(me.pageIndexInput,"keypress"),me.keyMap.addKey(13,me.onJumpPage,me);for(var i=0;i<10;i++)me.keyMap.addKey(NUMBER_CODE[i]);if(me.keyMap.preventKeyEvent(),me.keyMap.bindKeyEvent(),me.jumpPageBtn=createButtonHandler.call(me,cns[3],me.onJumpPage),!me.hidePageSizeSelect)for(dom=dom.childNodes[3],i=0,len=me.pageSizeOptions.length;i<len;i++)cns=me.pageSizeOptions[i],(btn=new buttonClazz({cls:"c-pgbar-pgszbtn",value:cns,text:cns,tooltip:"每页"+cns+"条",handler:me.fireLimitChangeEvent,scope:me})).render(dom),me.pageLimit===cns&&(me.activePageSizeBtn=btn,btn.active())},appendBtn:function(key,text,cls,icon,hanlder){var me=this,btn=new buttonClazz({key:key,text:text,cls:cls,icon:icon,handler:hanlder,scope:me});return btn.render(me.btnBox),btn},fireLimitChangeEvent:function(btn){var me=this,value=btn.value,limit=me.getPageLimit();value!==limit&&(me.pageLimit=value,!1!==me.fireEvent("limitchange",value,limit,me)?(me.activePageSizeBtn.unactive(),btn.active(),me.activePageSizeBtn=btn):me.pageLimit=limit)},fireIndexChangeEvent:function(pageIndex){var me=this;me.fireEvent("indexchange",pageIndex,me.getPageIndex(),me)},onBackwardPage:function(btn){var me=this,ix=me.getPageIndex()-1;ix>-1&&me.fireIndexChangeEvent(ix)},onForwardPage:function(){var me=this,ix=me.getPageIndex()+1;ix<me.pageSize&&me.fireIndexChangeEvent(ix)},onLastPage:function(){var me=this,ix=me.pageSize-1;me.getPageIndex()!==ix&&me.fireIndexChangeEvent(ix)},onFirstPage:function(btn){var me=this;0!==me.getPageIndex()&&me.fireIndexChangeEvent(0)},onPageIndex:function(btn){var me=this,ix=btn.pageIndex;me.fireIndexChangeEvent(ix-1)},onJumpPage:function(){var me=this,ix=me.pageIndexInput.dom.value;(ix=UV.toInteger(ix,0))>0&&ix<=me.pageSize&&me.fireIndexChangeEvent(ix-1)}})}})}(),function(){var HTML_TMP=[],MASK_HTML=[];HTML_TMP.push('<div class="c-panel-box">'),HTML_TMP.push('<div class="c-panel-top">'),HTML_TMP.push('<div class="c-panel-title"><div class="icon"></div><div class="text"></div></div>'),HTML_TMP.push('<div class="c-panel-tools"></div>'),HTML_TMP.push("</div>"),HTML_TMP.push('<div class="c-panel-center"><div class="c-panel-center-inner">'),HTML_TMP.push('<div class="c-panel-tbar"></div>'),HTML_TMP.push('<div class="c-panel-body"><div class="c-panel-body-inner"></div></div>'),HTML_TMP.push('<div class="c-panel-fbar"></div>'),HTML_TMP.push("</div></div>"),HTML_TMP.push('<div class="c-panel-bottom"></div>'),HTML_TMP.push("</div>"),HTML_TMP=HTML_TMP.join(""),MASK_HTML.push('<div class="c-panel-mask-inner">'),MASK_HTML.push('<div class="c-panel-mask-msgbox">'),MASK_HTML.push('<div class="c-panel-mask-icon"></div>'),MASK_HTML.push('<div class="c-panel-mask-msg"></div>'),MASK_HTML.push("</div></div>"),MASK_HTML=MASK_HTML.join(""),Cmp.define("Cmp.Panel",{extend:"Cmp.Contaner",requires:["Cmp.Button"],cls:!0,factory:function(ext,reqs){var superClazz=ext.prototype,buttonClazz=reqs[0];return Cmp.extend(ext,{showMask:function(msg){var me=this;me.el?(me.mask||(me.mask=me.box.createChild({cls:"c-panel-mask",html:MASK_HTML}),me.mask.setHideModal("display"),me.maskMsg=Cmp.get(me.mask.dom.firstChild.firstChild.childNodes[1])),me.maskMsg.update(msg||"请稍等..."),me.mask.show()):me.maskMsg=msg},hideMask:function(){var me=this;me.mask&&me.mask.hide()},initComponent:function(){var me=this,cls=me.cls;isA(cls)?cls.unshift("c-panel"):cls=isS(cls)?["c-panel",cls]:"c-panel",me.cls=cls,superClazz.initComponent.call(me)},doRender:function(){var dom,me=this;!0===me.shadow&&me.el.addClass("c-panel-shadow"),!0===me.frame&&me.el.addClass("c-panel-frame"),!0===me.actived&&me.el.addClass("c-panel-actived"),me.el.update(HTML_TMP),dom=me.el.dom.firstChild,me.box=Cmp.get(dom),dom=me.el.dom.firstChild.firstChild,me.topBox=Cmp.get(dom),dom=dom.firstChild,me.titleIconBox=Cmp.get(dom.firstChild),me.titleTextBox=Cmp.get(dom.childNodes[1]),dom=me.el.dom.firstChild.childNodes[1],me.centerBox=Cmp.get(dom),dom=dom.firstChild,me.tbarBox=Cmp.get(dom.firstChild),me.body=Cmp.get(dom.childNodes[1].firstChild),me.bbarBox=Cmp.get(dom.childNodes[2]),dom=me.el.dom.firstChild.childNodes[2],me.bottomBox=Cmp.get(dom),me.renderTop(),me.renderCenter(),me.renderBottom(),superClazz.doRender.call(me),me.autoSize&&me.el.addClass("c-panel-autosize")},getLayoutTarget:function(){return this.body},renderTop:function(){var me=this;!0===me.hideTitle?me.el.addClass("c-panel-notop"):((isS(me.icon)||isA(me.icon))&&me.titleIconBox.addClass(me.icon),isS(me.title)&&me.titleTextBox.update(me.title))},renderCenter:function(){var me=this;me.noborder&&me.centerBox.addClass("c-panel-noborder"),me.tbar?(isA(me.tbar)||isO(me.tbar)&&isF(me.tbar.render),isF(me.tbar.render)&&me.tbar.render(me.tbarBox)):me.centerBox.addClass("c-panel-notbar"),me.bbar?isF(me.bbar.render)&&me.tbar.render(me.bbarBox):me.centerBox.addClass("c-panel-nobbar")},renderBottom:function(){var me=this;if(isA(me.buttons))for(var b,i=0,len=me.buttons.length;i<len;i++)(b=me.buttons[i])&&(isF(b.render)||(b=new buttonClazz(b)),b.render(me.bottomBox));else me.el.addClass("c-panel-nobottom")}})}})}(),function(){var HTML_TMP,DH=Cmp.util.DomHelper,UV=Cmp.util.ValueHelper,html=[];html.push('<div class="c-tip-box">'),html.push('<div class="c-tip-inner">'),html.push('<div class="c-tip-icon">'),html.push('</div><div class="c-tip-body">&nbsp;</div>'),html.push('<div class="c-tip-close">'),html.push("</div></div>"),html.push('<div class="c-tip-arrow"></div></div>'),html.push("</div>"),HTML_TMP=html.join("");var getTooltipPosInfoByRT=function(txy,tsz,sz){return{xy:[txy[0]+tsz.width,txy[1]],arrowCls:"c-tip-ltarrow"}},POS_HANDLERS={tl:function(txy,tsz,sz){return{xy:[txy[0],txy[1]-sz.height],arrowCls:"c-tip-blarrow"}},tr:function(txy,tsz,sz){return{xy:[txy[0]-sz.width+tsz.width,txy[1]-sz.height],arrowCls:"c-tip-brarrow"}},bl:function(txy,tsz,sz){return{xy:[txy[0],txy[1]+tsz.height],arrowCls:"c-tip-tlarrow"}},br:function(txy,tsz,sz){return{xy:[txy[0]-sz.width+tsz.width,txy[1]+tsz.height],arrowCls:"c-tip-trarrow"}},lt:function(txy,tsz,sz){return{xy:[txy[0]-sz.width,txy[1]],arrowCls:"c-tip-rtarrow"}},lb:function(txy,tsz,sz){return{xy:[txy[0]-sz.width,txy[1]+tsz.height-sz.height],arrowCls:"c-tip-rbarrow"}},rt:getTooltipPosInfoByRT,rb:function(txy,tsz,sz){return{xy:[txy[0]+tsz.width,txy[1]+tsz.height-sz.height],arrowCls:"c-tip-lbarrow"}}},getTooltipPosInfoByAuto=function(txy,tsz,sz){var me=this;return getTooltipPosInfoByRT.call(me,txy,tsz,sz)},getTooltipPosInfo=function(target,pos,showArrow){var txy,tsz,dom,fn,rel,me=this,sz=me.el.getSize();return!!target&&(isE(target)?dom=target:isO(target)?dom=isF(target.render)?target.el.dom:target.dom:isS(target)&&(dom=document.getElementById(target)),!!dom&&(txy=DH.getXY(dom),tsz={width:DH.getWidth(dom),height:DH.getHeight(dom)},fn=POS_HANDLERS[pos],isF(fn)||(fn=getTooltipPosInfoByAuto),rel=fn.call(me,txy,tsz,sz),!1===showArrow&&(rel.arrowCls="c-tip-noarrow"),rel))};Cmp.define("Cmp.Tooltip",{extend:"Cmp.Widget",cls:!0,factory:function(ext,reqs){var superclass=ext.prototype;return Cmp.extend(ext,{showBy:function(el,pos,showArrow){var me=this;if(!me.rendered)return me.render(Cmp.getBody()),void window.setTimeout(function(){me.showBy(el,pos,showArrow)},10);me.show();var v,ps=getTooltipPosInfo.call(me,el,pos,showArrow);ps&&(v=ps.arrowCls,me._arrowCls!==v&&(me._arrowCls&&me.el.removeClass(me._arrowCls),me.el.addClass(v),me._arrowCls=v),v=ps.xy,me.el.setStyle({left:v[0]+"px",top:v[1]+"px"}),me.fireEvent("show",me))},show:function(){var me=this;superclass.show.call(me),me.autoHideTask&&me.autoHideTask.run()},hide:function(){var me=this;me.autoHideTask&&me.autoHideTask.cancel(),superclass.hide.call(me),me.fireEvent("hide",me)},setTooltip:function(tip){var tx,ic,me=this;if(me.rendered)if(isS(tip)?tx=tip:isO(tip)&&(tx=tip.text,ic=tip.icon),me.bodyBox.update(tx||"&nbsp;"),isS(ic)||isA(ic)){me.el.removeClass("c-tip-noicon");var cs=["c-tip-icon"];isS(ic)?cs.push(ic):cs=cs.concat(ic),me.iconBox.setClass(cs)}else me.el.addClass("c-tip-noicon");else me.initTip=tip},initComponent:function(){var v,me=this;superclass.initComponent.call(me);var cls=["c-tip"];isS(me.cls)?cls.push(me.cls):isA(me.cls)&&(cls=cls.concat(me.cls)),me.cls=cls,me.addEvents("show","hide"),me.closable=!1!==me.closable,v=me.closable?0:3e3,(v=UV.toInteger(me.autoCloseDelay,v))>999&&(me.autoHideTask=new Cmp.util.DelayedTask({delay:v,handler:me.hide,scope:me}),delete me.autoCloseDelay)},doRender:function(){var cns,me=this;if(superclass.doRender.call(me),me.el.setHideModal("display"),me.el.update(HTML_TMP),cns=me.el.dom.firstChild.firstChild.childNodes,me.box=Cmp.get(me.el.dom.firstChild),me.iconBox=Cmp.get(cns[0]),me.bodyBox=Cmp.get(cns[1]),me.closeBox=Cmp.get(cns[2]),me.closeBox.on("click",me.onClickClose,me),me.closable||me.el.addClass("c-tip-noclose"),me.initTip){var tx,ic;isS(me.initTip)?tx=me.initTip:isO(me.initTip)&&(tx=me.initTip.text,ic=me.initTip.icon),me.bodyBox.update(tx||"&nbsp;"),ic?me.iconBox.addClass(ic):me.el.addClass("c-tip-noicon"),delete me.initTip}else me.el.addClass("c-tip-noicon")},onClickClose:function(){this.hide()}})}})}(),function(){var activeWin,getDefaultXY=function(box,win){var bw=box.getWidth(),bh=box.getHeight(),x=(bw-win.box.getWidth())/2,y=(bh-win.box.getHeight())/2;return x=x>0?x:0,y=y>0?y:0,[x,y]},setWinLeftAndTop=function(win,xy,isCenter){var x,y;if(!0===isCenter)win.el.getWidth(),win.el.getHeight();else x=xy[0],y=xy[1],isN(x)&&(x+="px"),isN(y)&&(y+="px"),win.el.setStyle({top:y,left:x})},winArray=[],sortWindowLayer=function(win){var wid,i,len,me=this;if(win)for(wid=win.getId(),activeWin&&winArray.push(activeWin),i=0,len=winArray.length;i<len;i++)winArray[i]==wid&&winArray.splice(i,1);else winArray.length>0&&(wid=winArray.pop());if(wid){var sm=!1;for((win=Cmp.getCmp(wid)).modal&&(sm=!0),win.el.removeClass("xp-win-unactive"),win.el.setStyle("zIndex",1e5),activeWin=wid,i=0,len=winArray.length;i<len;i++)wid=winArray[i],(win=Cmp.getCmp(wid)).modal&&(sm=!0),win.el.addClass("xp-win-unactive"),win.el.setStyle("zIndex",99980-len+i);sm||me.hideMask()}else activeWin=!1,me.hideMask()},Rel={getActiveMask:function(){var mask=Rel.activeMask;return mask||((mask=Rel.getWindowsBox().createChild({cls:"c-win-actmask",style:{zIndex:1e5+5}})).setHideModal("display"),Rel.activeMask=mask),mask},activeWindow:function(win){},showWindow:function(win,xy,isCenter){var box=Rel.getWindowsBox();win&&isF(win.render)&&win.render(box),win.el.setStyle("display","block"),!0===win.modal&&Rel.showMask(),xy||(xy=getDefaultXY(box,win),isCenter=!1),setWinLeftAndTop(win,xy,isCenter),sortWindowLayer.call(Rel,win)},hideWindow:function(win){if(!win||!win.el||!isF(win.el.hide))return!1;var wid=win.getId();if(win.el.hide(),activeWin===wid)activeWin=!1,sortWindowLayer.call(Rel);else for(var i=0,len=winArray.length;i<len;i++)winArray[i]==wid&&winArray.splice(i,1);return!0},getWindowsBox:function(){var me=this;return me.windowBox||(me.windowBox=Cmp.getBody()),me.windowBox},showMask:function(){Rel.mask?Rel.mask.show():(Rel.mask=Rel.getWindowsBox().createChild({cls:"c-win-mask",style:{zIndex:99990}}),Rel.mask.setHideModal("display"))},hideMask:function(){Rel.mask&&Rel.mask.hide()}};Cmp.define("Cmp.WindowMng",{factory:function(ext,reqs){return Rel}})}(),function(){var WindowMng,HTML,DH=Cmp.util.DomHelper;(HTML=[]).push('<div class="c-win-box">'),HTML.push('<div class="c-win-head">'),HTML.push('<div class="c-win-headbox">'),HTML.push('<div class="c-win-title"><div class="c-win-title-inner"><i class="fa"></i><strong></strong></div></div>'),HTML.push('<div class="c-win-tools"></div>'),HTML.push("</div>"),HTML.push("</div>"),HTML.push('<div class="c-win-inner">'),HTML.push('<div class="c-win-innerbox">'),HTML.push('<div class="c-win-ml"></div>'),HTML.push('<div class="c-win-mm">'),HTML.push('<div class="c-win-wrap">'),HTML.push('<div class="c-win-body"><div class="c-win-body-inner"></div></div>'),HTML.push('<div class="c-win-foot"><div class="c-win-foot-inner"></div></div>'),HTML.push("</div>"),HTML.push("</div>"),HTML.push('<div class="c-win-mr"></div>'),HTML.push('<div class="c-win-bl"></div>'),HTML.push('<div class="c-win-bm"></div>'),HTML.push('<div class="c-win-br"></div>'),HTML.push("</div>"),HTML.push("</div>"),HTML.push("</div>"),HTML=HTML.join("");var onMouseDownByResize=function(ev){var me=this,dom=me.el.dom,dm=ev.target,mk=(dm.className,WindowMng.getActiveMask());me.active(),me.resizeCache={dir:dm.className,sx:DH.getStyleNumber(dom,"left"),sy:DH.getStyleNumber(dom,"top"),sw:DH.getWidth(dom),sh:DH.getHeight(dom),mx:ev.clientX,my:ev.clientY},mk.on("mousemove",onMouseMoveByResize,me),mk.on("mouseup",onMouseUpByResize,me),mk.show(),mk.setStyle("cursor",DH.getStyle(dm,"cursor"))},onMouseMoveByResize=function(ev){var me=this,dom=me.el.dom,c=me.resizeCache;ev.target;if("c-win-ml"===c.dir){var off=ev.clientX-c.mx,x=c.sx+off;(w=c.sw-off)>=MIN_WIDTH&&DH.setStyle(dom,{left:x+"px",width:w+"px"})}else if("c-win-mr"===c.dir){off=ev.clientX-c.mx;(w=c.sw+off)>=MIN_WIDTH&&DH.setStyle(dom,{width:w+"px"})}else if("c-win-bm"===c.dir){off=ev.clientY-c.my;(h=c.sh+off)>=MIN_HEIGHT&&DH.setStyle(dom,{height:h+"px"})}else if("c-win-bl"===c.dir){var offX=ev.clientX-c.mx,offY=ev.clientY-c.my,x=c.sx+offX,w=c.sw-offX,h=c.sh+offY,r=!1,o={};w>=MIN_WIDTH&&(o.left=x+"px",o.width=w+"px",r=!0),h>=MIN_HEIGHT&&(o.height=h+"px",r=!0),r&&DH.setStyle(dom,o)}else if("c-win-br"===c.dir){var offX=ev.clientX-c.mx,offY=ev.clientY-c.my,w=c.sw+offX,h=c.sh+offY,r=!1,o={};w>=MIN_WIDTH&&(o.width=w+"px",r=!0),h>=MIN_HEIGHT&&(o.height=h+"px",r=!0),r&&DH.setStyle(dom,o)}},onMouseUpByResize=function(ev){var me=this,mk=WindowMng.getActiveMask();delete me.resizeCache,mk.un("mousemove",onMouseMoveByResize,me),mk.un("mouseup",onMouseUpByResize,me),mk.hide(),me.fireResizeEvent()},onMouseDownByMove=function(ev){var me=this;ev.target;dom=me.el.dom,mk=WindowMng.getActiveMask(),me.active(),me.moveCache={sx:DH.getStyleNumber(dom,"left"),sy:DH.getStyleNumber(dom,"top"),mx:ev.clientX,my:ev.clientY},mk.on("mousemove",onMouseMoveByMove,me),mk.on("mouseup",onMouseUpByMove,me),mk.show()},onMouseMoveByMove=function(ev){var me=this,dom=me.el.dom,c=me.moveCache,offX=ev.clientX-c.mx,offY=ev.clientY-c.my,x=c.sx+offX,y=c.sy+offY,r=!1;o={},x>=0&&(o.left=x+"px",r=!0),y>=0&&(o.top=y+"px",r=!0),r&&DH.setStyle(dom,o)},onMouseUpByMove=function(ev){var me=this,mk=WindowMng.getActiveMask();delete me.moveCache,mk.un("mousemove",onMouseMoveByMove,me),mk.un("mouseup",onMouseUpByMove,me),mk.hide()};Cmp.define("Cmp.Window",{extend:"Cmp.Widget",requires:["Cmp.Button","Cmp.WindowMng"],cls:!0,factory:function(ext,reqs){var superClass=ext.prototype,Button=reqs[0];return WindowMng=reqs[1],Cmp.extend(ext,{active:function(){WindowMng.activeWindow(this)},setTitle:function(title){var me=this;me.titleBox?me.titleBox.update(title||""):me.title=title},setIcon:function(icon){var me=this,box=me.iconBox;box&&box.icon!==icon&&(box.icon&&box.removeClass(box.icon),icon?(box.addClass(icon),box.icon||me.head.addClass("c-win-headbox-icon")):box.icon&&me.head.removeClass("c-win-headbox-icon"),box.icon=icon)},showAt:function(xy,noCenter){WindowMng.showWindow(this,xy,noCenter)},show:function(){var me=this;WindowMng.showWindow(me),me.fireEvent("show",me)},hide:function(){var me=this;WindowMng.hideWindow(me),me.fireEvent("hide",me)},close:function(){var me=this;me.hide(),me.destroy()},initComponent:function(){var me=this;superClass.initComponent.call(me);var cls=["c-win"];isS(me.cls)?cls.push(me.cls):isA(me.cls)&&(cls=cls.concat(me.cls)),me.cls=cls,me.addEvents("hide","show")},doRender:function(){var me=this;superClass.doRender.call(me),me.el.setHideModal("display"),me.el.update(HTML),dom=me.el.dom.firstChild,me.box=Cmp.get(dom),!0===me.hideHead?(me.el.addClass("c-win-nohead"),me.resizeble=!1):me.initHead(dom),me.initBody(dom),isO(me.buttons)||isA(me.buttons)&&me.buttons.length>0?me.initFoot(dom):me.el.addClass("c-win-nofoot"),!0===me.resizeble?me.initResizeEvent(dom):me.el.addClass("c-win-noresize")},initHead:function(boxDom){var ddom,me=this,dom=boxDom.firstChild.firstChild;me.head=Cmp.get(dom),me.titleWarp=Cmp.get(dom.firstChild),ddom=dom.firstChild.firstChild,me.titleInner=Cmp.get(ddom),me.iconBox=Cmp.get(ddom.firstChild),me.titleBox=Cmp.get(ddom.childNodes[1]),me.toolBox=Cmp.get(dom.childNodes[1]),me.setIcon(me.icon),me.setTitle(me.title),!0===me.closable&&new Button({icon:["fa","fa-times"],title:"关闭",handler:me.hide,scope:me}).render(me.toolBox),!0===me.movesable&&(me.titleInner.on("mousedown",onMouseDownByMove,me),me.head.addClass("c-win-movesable"))},initBody:function(boxDom){var me=this,dom=boxDom.childNodes[1];dom=dom.firstChild.childNodes[1].firstChild.firstChild.firstChild,me.body=Cmp.get(dom),isO(me.content)?isF(me.content.render)?me.content.render(me.body):Cmp.create(me.content,function(o){o&&isF(o.render)&&(me.content=0,me.content.render(me.body))}):isS(me.innerHTML)&&me.body.update(me.innerHTML)},initFoot:function(boxDom){var me=this,btns=me.buttons,dom=boxDom.childNodes[1];dom=(dom=boxDom.childNodes[1]).firstChild.childNodes[1].firstChild.childNodes[1].firstChild,me.foot=Cmp.get(dom),isO(btns)&&!isA(btns)&&(btns=[btns]);for(var b,i=0,len=btns.length;i<len;i++)b=btns[i],isO(b)&&(isF(b.render)||(b=new Button(b)),b.render(me.foot))},initResizeEvent:function(boxDom){var el,me=this,dom=boxDom.childNodes[1].firstChild,els={};(el=Cmp.get(dom.firstChild)).on("mousedown",onMouseDownByResize,me),els.l=el,(el=Cmp.get(dom.childNodes[2])).on("mousedown",onMouseDownByResize,me),els.r=el,(el=Cmp.get(dom.childNodes[3])).on("mousedown",onMouseDownByResize,me),els.bl=el,(el=Cmp.get(dom.childNodes[4])).on("mousedown",onMouseDownByResize,me),els.b=el,(el=Cmp.get(dom.childNodes[5])).on("mousedown",onMouseDownByResize,me),els.b=el,me.resizeBoxs=els},doDestroy:function(){var me=this;superClass.doDestroy.call(me)},fireResizeEvent:function(){var me=this;w=me.el.getWidth(),h=me.el.getHeight(),me.onResize(),me.fireEvent("resize",w,h,me)}})}})}(),Cmp.define("Cmp.form.Field",{extend:"Cmp.Widget",cls:!0,factory:function(ext,reqs){var superClazz=ext.prototype;return Cmp.extend(ext,{enable:function(){var me=this;me.disabled&&(me.doEnable(),me.disabled=!1)},disable:function(){var me=this;me.disabled||(me.doDisable(),me.disabled=!0)},isDisabled:function(){return this.disabled},setValue:Cmp.emptyFn,getValue:Cmp.emptyFn,initComponent:function(){var me=this,cls=["c-fd"];isS(me.cls)?cls.push(me.cls):isA(me.cls)&&(cls=cls.concat(me.cls)),me.cls=cls,superClazz.initComponent.call(me),me.addEvents("changed")},doRender:function(){var me=this;superClazz.doRender.call(me),me.hideLabel=!!me.hideLabel;var el,lw="0px";me.hideLabel||(lw=me.labelWidth,isN(lw)&&(lw+="px"),isS(lw)||(lw="5rem"),el=me.el.createChild({cls:"c-fd-lb",style:{width:lw},html:"<strong>"+(me.label||"")+"</strong><i></i><b></b>"}),me.labelBox=Cmp.get(el.dom.firstChild)),el=me.el.createChild({cls:"c-fd-inbox",style:{paddingLeft:lw},html:'<div class="c-fd-inwarp"></div>'}),me.inputBox=Cmp.get(el.dom.firstChild),me.renderInput(me.inputBox),me.errorBox=me.inputBox.createChild({cls:"c-fd-error-msg"}),me.el.setStyle({minWidth:lw}),el=!!me.disabled,me.disabled=!1,el&&me.disable(),void 0!=me.value&&(el=me.value,me.value=void 0,me.setValue(el))},doEnable:function(){var me=this;me.el&&me.el.removeClass("c-fd-disabled")},doDisable:function(){var me=this;me.el&&me.el.addClass("c-fd-disabled")},showError:function(msg){var me=this;me._hasError||(me._hasError=!0,me.el.addClass("c-fd-error")),me.updateErrorMsg(msg)},hideError:function(){var me=this;me._hasError&&(me._hasError=!1,me.el.removeClass("c-fd-error")),me.updateErrorMsg()},updateErrorMsg:function(msg){var me=this;me.errorBox&&me.errorBox.update(msg||"")},renderInput:Cmp.emptyFn})}}),Cmp.define("Cmp.form.TextField",{extend:"Cmp.form.Field",cls:!0,factory:function(ext,reqs){var superClazz=ext.prototype;return Cmp.extend(ext,{getValue:function(){var me=this;return me.input?me.input.dom.value:me.value},setValue:function(value){var me=this;me.input&&(me.input.dom.value=value||"")},setReadOnly:function(readOnly){var me=this;readOnly=!!readOnly,me.input&&(readOnly?(me.input.dom.readOnly=!0,me.inputBox.addClass("c-fd-readonly")):(me.input.dom.readOnly=!1,me.inputBox.removeClass("c-fd-readonly"))),me.readOnly=readOnly},initComponent:function(){var me=this,cls=me.cls;isA(cls)?cls.unshift("c-tfd"):cls=isS(cls)?["c-tfd",cls]:"c-tfd",me.cls=cls,superClazz.initComponent.call(me)},renderInput:function(box){var me=this;if(superClazz.renderInput.call(me,box),me.input=box.createChild({tag:"input",atts:{placeholder:me.emptyText||"",type:"password"===me.type?"password":"text",name:me.name||"",maxLength:me.maxLength||void 0}}),me.readOnly&&(me.input.dom.readOnly=!0,box.addClass("c-fd-readonly")),me.input.on("blur",me.onInputBlur,me),me.value){var v=me.value;delete me.value,me.setValue(v)}},onInputBlur:function(){var me=this;me.fireEvent("changed",me.getValue(),me)},doDisable:function(){var me=this;superClazz.doDisable.call(me),me.input.dom.disabled=!0},doEnable:function(){var me=this;superClazz.doEnable.call(me),me.input.dom.disabled=!1}})}}),function(){var ICON_MAP={search:"fa-search",left:"fa-angle-left",right:"fa-angle-right",up:"fa-angle-up",down:"fa-angle-down",calendar:"fa-calendar",gear:"gear"};Cmp.define("Cmp.form.Trigger",{extend:"Cmp.form.TextField",cls:!0,factory:function(ext,reqs){var superClazz=ext.prototype;return Cmp.extend(ext,{initComponent:function(){var me=this,cls=["c-trg"];isS(me.cls)?cls.push(me.cls):isA(me.cls)&&(cls=cls.concat(me.cls)),me.cls=cls,superClazz.initComponent.call(me)},renderInput:function(box){var me=this,cls=["c-trg-btn","fa"];superClazz.renderInput.call(me,box),isA(me.btnIcon)?cls=cls.concat(me.btnIcon):isS(me.btnIcon)?cls.push(me.btnIcon):cls.push(ICON_MAP[me.btnType]||ICON_MAP.search),me.trigetBtn=box.createChild({cls:cls}),me.trigetBtn.on("click",me.onClickTrigger,me),me.readOnly&&me.input.on("click",me.onClickTrigger,me)},onClickTrigger:function(){var me=this;me.disaebed||me.doClickTrigger()},doClickTrigger:Cmp.emptyFn})}})}(),function(){var dateList,getDateList=function(listClazz){if(dateList)return dateList;var rel={warp:Cmp.getBody().createChild({cls:"c-datefield-listwarp"}),dataList:new listClazz({cls:"c-detelist-tlarrow"}),mask:Cmp.getBody().createMask("ComboxMask",9e5),showed:!1};return rel.invokeCallback=function(date){isF(rel.callback)&&rel.callback.call(rel.scope,date)},rel.dataList.on("clickday",rel.invokeCallback,rel),rel.warp.setHideModal("display"),rel.dataList.render(rel.warp),rel.warp.hide(),rel.setValue=function(value,refresh){rel.dataList.setValue(value,refresh)},rel.setValueRange=function(min,max){rel.dataList.setValueRange(min,max)},rel.isShowed=function(){return rel.showed},rel.hide=function(){rel.showed=!1,rel.warp.hide(),rel.mask.hide(),rel.mask.un("click",rel.invokeCallback,rel)},rel.show=function(xy,callback,scope){rel.isShowed()||(rel.showed=!0,rel.warp.setStyle({left:xy[0]+"px",top:xy[1]+"px"}),rel.warp.show(),rel.mask.show(),rel.mask.on("click",rel.invokeCallback,rel),rel.callback=callback,rel.scope=scope)},dateList=rel},toString=function(date){var v,rel=[];return rel.push(date.getFullYear()),rel.push("年"),(v=date.getMonth()+1)<10&&rel.push("0"),rel.push(v),rel.push("月"),(v=date.getDate())<10&&rel.push("0"),rel.push(v),rel.push("日"),rel.join("")},equals=function(d1,d2){return d1===d2};Cmp.define("Cmp.form.DateField",{extend:"Cmp.form.Trigger",requires:["Cmp.DateList"],cls:!0,factory:function(ext,reqs){var superClazz=ext.prototype,dateListClazz=reqs[0];return Cmp.extend(ext,{setMinValue:function(minValue){var me=this;me.setValueRange(minValue,me.maxValue)},setMaxValue:function(maxValue){var me=this;me.setValueRange(me.minValue,maxValue)},setValueRange:function(minValue,maxValue){var me=this;v=minValue,isD(v)||(v=new Date(1970,0,1)),me.minValue=v,v=maxValue,isD(v)||(v=new Date(2099,11,31)),me.maxValue=v,me.minValue.getTime()>me.maxValue.getTime()&&(v=me.minValue,me.minValue=me.maxValue,me.maxValue=v),v=me.value,isD(v)&&(v=v.getTime(),v>me.maxValue.getTime()?me.value=me.maxValue:v<me.minValue.getTime()&&(me.value=me.minValue))},getValue:function(){return this.value},setValue:function(value){var me=this;isD(value)?me.value=value:me.value=void 0,me.input&&(me.input.dom.value=me.value?toString(me.value):"")},initComponent:function(){var v,me=this;me.btnType="calendar",me.readOnly=!0,v=me.cls,isA(v)?v.unshift("c-datefield"):v=isS(v)?["c-datefield",v]:"c-datefield",me.cls=v,superClazz.initComponent.call(me),v=me.minValue,isD(v)||(v=new Date(1970,0,1)),me.minValue=v,v=me.maxValue,isD(v)||(v=new Date(2099,11,31)),me.maxValue=v,me.minValue.getTime()>me.maxValue.getTime()&&(v=me.minValue,me.minValue=me.maxValue,me.maxValue=v),me.addEvents("collect","extend")},doClickTrigger:function(){var me=this;me.disabled||(me.extended?me.doCollect():me.doExtend())},doExtend:function(){var me=this;if(!me.extended){me.extended=!0;var list=me.getDateList(),h=me.input.getHeight(),xy=me.input.getXY();list.setValueRange(me.minValue,me.maxValue),list.setValue(me.getValue(),!0),list.show([xy[0],xy[1]+h],me.doListCallback,me),me.el.addClass("c-datefield-extended"),me.fireEvent("extend",me)}},doListCallback:function(value){var me=this,ov=me.value;isD(value)&&(me.value=value,me.input.dom.value=toString(value)),me.doCollect(),isD(value)&&!equals(ov,value)&&me.fireEvent("changed",value,ov,me)},doCollect:function(){var me=this;me.extended&&(me.extended=!1,me.getDateList().hide(),me.el.removeClass("c-datefield-extended"),me.fireEvent("collect",me))},getDateList:function(){return getDateList(dateListClazz)}})}})}(),function(){var toNextDay=function(d){var t=d.getTime()+864e5;return new Date(t)},toBackDay=function(d){var t=d.getTime()-864e5;return new Date(t)};Cmp.define("Cmp.form.DateRange",{extend:"Cmp.form.Field",requires:["Cmp.form.DateField"],cls:!0,factory:function(ext,reqs){var superClazz=ext.prototype,dateFieldClazz=reqs[0];return Cmp.extend(ext,{setValueRange:function(range){range=range||{};var sv,ev,time,me=this,min=isD(range.minValue)?range.minValue:new Date(1970,0,1),max=isD(range.maxValue)?range.maxValue:new Date(2099,11,31);me.minValue=min,me.maxValue=max,me.startInput&&(min=min.getTime(),max=max.getTime(),sv=me.startInput.getValue(),ev=me.endInput.getValue(),sv&&((time=sv.getTime())<min||time>max)&&me.startInput.setValue(me.minValue),ev&&((time=ev.getTime())<min||time>max)&&me.endInput.setValue(me.maxValue),me.startInput.setValueRange(me.minValue,toBackDay(me.maxValue)),me.endInput.setValueRange(toNextDay(me.minValue),me.maxValue))},setValue:function(value){var me=this,sv=(value=value||{}).start,ev=value.end;me.startInput&&me.endInput?(me.startInput.setValue(sv),isD(sv)?me.endInput.setMinValue(toNextDay(sv)):me.endInput.setMinValue(toNextDay(me.minValue)),me.endInput.setValue(ev),isD(ev)?me.startInput.setMaxValue(toBackDay(ev)):me.startInput.setMaxValue(toBackDay(me.maxValue))):me.value=value},getValue:function(){var me=this;return me.startInput&&me.endInput?{start:me.startInput.getValue(),end:me.endInput.getValue()}:me.value},initComponent:function(){var v,cls,me=this;cls=["c-daterange"],isS(me.cls)?cls.push(me.cls):isA(me.cls)&&(cls=cls.concat(me.cls)),me.cls=cls,superClazz.initComponent.call(me),v=me.minValue,isD(v)||(v=new Date(1970,0,1)),me.minValue=v,v=me.maxValue,isD(v)||(v=new Date(2099,11,31)),me.maxValue=v},renderInput:function(el){var me=this;superClazz.renderInput.call(me,el);var w=me.inputWidth;isN(w)&&(w+="px"),me.startBox=el.createChild({cls:"c-daterange-start"}),me.textBox=el.createChild({tag:"span",cls:"c-daterange-text",html:me.text||"至"}),me.endBox=el.createChild({cls:"c-daterange-end"}),isS(w)&&(me.startBox.setStyle("width",w),me.endBox.setStyle("width",w)),me.startInput=new dateFieldClazz({hideLabel:!0,minValue:me.minValue,maxValue:toBackDay(me.maxValue),emptyText:me.startEmptyText||"起始日期"}),me.startInput.render(me.startBox),me.endInput=new dateFieldClazz({hideLabel:!0,minValue:toNextDay(me.minValue),maxValue:me.maxValue,emptyText:me.endEmptyText||"截止日期"}),me.endInput.render(me.endBox),me.startInput.on("changed",me.onStartValueChanged,me),me.endInput.on("changed",me.onEndValueChanged,me),me.value&&(v=me.value,delete me.value,me.setValue(v))},onStartValueChanged:function(newValue,oldValue,field){this.endInput.setMinValue(toNextDay(newValue))},onEndValueChanged:function(newValue,oldValue,field){this.startInput.setMaxValue(toBackDay(newValue))}})}})}(),Cmp.define("Cmp.form.ComboBox",{extend:"Cmp.form.Trigger",requires:["Cmp.util.ArrayTableModel"],cls:!0,factory:function(ext,reqs){var superClazz=ext.prototype,modelClazz=reqs[0];return Cmp.extend(ext,{setOptions:function(ops){var me=this;{if(me.input){for(var o,v,t,i=0,len=isA(ops)?ops.length:0,vs=[],flag=!1;i<len;i++)o=ops[i],isO(o)?(v=o.value,t=void 0===o.text?v:o.text):isS(o)&&(t=v=o),void 0!==v&&null!==v&&(v===me.value&&(flag=!0),vs.push([v,t]));return me.data.reload(vs),flag||(me.value=void 0,me.input.dom.value=""),me}me.options=ops}},setValue:function(value){var me=this;if(me.value!==value){if(me.value=value,me.data){var v=me.data.find(me.valueIndex,value);if(v&&v.length>0){v=(v=v[0]).get(me.textIndex),me.input.dom.value=v;for(var it,ix,its=me.optionItems,i=0,len=isA(its)?its.length:0;i<len;i++)(it=its[i]).value===value?(it.active(),ix=i):it.unactive();ix>-1&&(me.activeOption=its[ix])}else me.activeOption&&me.activeOption.unactive(),me.input.dom.value=""}me.fireEvent("changed",value,me)}},getValue:function(){return this.value},getTextByValue:function(value){var me=this;if(me.data){var r=me.data.getById(value);return r?r.get(me.textIndex):value}return value},collect:function(){var me=this;if(me.extended){me.extended=!1;var mask=me.getBodyMask();mask.hide(),me.el.removeClass("c-cbx-extended"),mask.un("click",me.collect,me),me.box.hide()}},extend:function(){var me=this;if(!me.extended){me.extended=!0;var w=me.input.getWidth(),h=me.input.getHeight(),xy=me.input.getXY();me.box.setLeftTop(xy[0],xy[1]+h),me.box.setWidth(w),me.box.show(),me.el.addClass("c-cbx-extended"),window.setTimeout(function(){var mask=me.getBodyMask();mask.show(),mask.on("click",me.collect,me)},10)}},doClickTrigger:function(){var me=this;me.disabled||(me.extended?me.collect():me.extend())},initComponent:function(){var me=this,cls=["c-cbx"];if(isS(me.cls)?cls.push(me.cls):isA(me.cls)&&(cls=cls.concat(me.cls)),me.cls=cls,me.readOnly=!1!==me.readOnly,me.btnType="down",superClazz.initComponent.call(me),!isO(me.data)||isA(me.options)){for(var o,v,t,i=0,len=isA(me.options)?me.options.length:0,vs=[];i<len;i++)o=me.options[i],isO(o)?(v=o.value,t=void 0!==o.text?o.text:v+"",vs.push([v,t])):(t=(v=o)?v+"":"",vs.push([v,t]));me.data=new modelClazz({keies:["value","text"],idIndex:0,values:vs}),me.valueIndex="value",me.textIndex="text"}else me.valueIndex=me.valueIndex||"value",me.textIndex=me.textIndex||me.valueIndex;me.data&&isF(me.data.on)&&me.data.on("changed",me.renderOptionItems,me)},renderInput:function(box){var me=this;superClazz.renderInput.call(me,box),me.getBodyMask(),me.renderOptionView(),me.renderOptionItems()},getBodyMask:function(){var me=this;return me.bodyMask||(me.bodyMask=Cmp.getBody().createMask("ComboxMask",9e5)),me.bodyMask},renderOptionView:function(){var me=this,cls=["c-cbx-opbox"];me.styleCls&&cls.push(me.styleCls),me.sizeCls&&cls.push(me.sizeCls),me.box=Cmp.getBody().createChild({cls:cls}),me.warp=me.box.createChild({cls:"c-cbx-opwarp"}),me.box.setHideModal("display"),me.box.hide(),me.box.on("click",me.collect,me)},renderOptionItems:function(){var me=this;if(me.optionItems)for(var i=0,len=me.optionItems.length;i<len;i++)me.optionItems[i].remove();for(var o,rs=me.data?me.data.getRecords():[],i=0,len=rs.length,items=[];i<len;i++)(o=me.renderOptionItem(me.warp,rs[i]))&&items.push(o);me.optionItems=items},renderOptionItem:function(box,r){var el,rel,me=this,v=r.get(me.valueIndex),t=r.get(me.textIndex);return el=box.createChild({cls:"c-cbx-op-item",atts:{value:v,title:t},html:t}),rel={el:el,value:v,actived:!1},rel.active=function(){rel.actived||(rel.el.addClass("c-cbx-op-item-active"),rel.actived=!0),me.activeOption=rel},rel.unactive=function(){rel.actived&&(rel.el.removeClass("c-cbx-op-item-active"),rel.actived=!1),me.activeOption=!1},rel.remove=function(){rel.el&&rel.el.remove()},rel.clickItem=function(){me.activeOption&&me.activeOption.unactive(),rel.active(),me.setValue(rel.value)},rel.el.on("click",rel.clickItem,rel),me.value==v&&rel.active(),rel},onInputBlur:Cmp.emptyFn})}}),Cmp.define("Cmp.form.Checkbox",{extend:"Cmp.form.Field",cls:!0,factory:function(ext,reqs){var superClazz=ext.prototype;return Cmp.extend(ext,{getValue:function(){return this.checkMode},setValue:function(value){var me=this;"true"===value||!0===value?value="checked":"false"===value&&(value=!1),me.checkMode!==value&&("checked"===value?me.toCheckedMode():"half"===value?me.toHalfCheckedMode():me.toUncheckedMode())},isCheckeded:function(){return"checked"===this.checkMode},isHalfChecked:function(){return"half"===this.checkMode},isUnchecked:function(){return!1===this.checkMode},initComponent:function(){var me=this,cls=me.cls;isA(cls)?cls.unshift("c-checkbox"):cls=isS(cls)?["c-checkbox",cls]:"c-checkbox",me.cls=cls,superClazz.initComponent.call(me),cls="half"===(cls=me.checked)?"half":(!0===cls||"true"===cls)&&"checked",me.checkMode=cls,delete me.checked,me.addEvents("click")},renderInput:function(box){var dom,me=this;me.warp=box.createChild({cls:"c-checkbox-warp",html:'<div class="c-checkbox-input"></div><div class="c-checkbox-text"></div>'}),dom=me.warp.dom,me.checkbox=Cmp.get(dom.firstChild),me.textBox=Cmp.get(dom.childNodes[1]),isS(me.text)&&me.textBox.update(me.text),!1!==me.checkMode&&(me.warp.addClass("c-checkbox-"+me.checkMode),"half"===me.checkMode&&me.checkbox.update('<span class="c-checkbox-half-outer"></span><span class="c-checkbox-half-inner"></span>')),me.checkbox.on("click",me.onClickInput,me)},onClickInput:function(){var me=this;me.isDisabled()||!1!==me.fireEvent("click",me.checkMode,!me.isCheckeded()&&"checked",me)&&(me.isCheckeded()?me.toUncheckedMode():me.toCheckedMode())},toCheckedMode:function(){var me=this;return me.isCheckeded()?me:(!1!==me.checkMode&&(me.warp.removeClass("c-checkbox-"+me.checkMode),me.checkbox.update("")),me.checkMode="checked",me.warp.addClass("c-checkbox-"+me.checkMode),me.fireEvent("changed",me.checkMode,me),me)},toHalfCheckedMode:function(){var me=this;return me.isHalfChecked()?me:(!1!==me.checkMode&&me.warp.removeClass("c-checkbox-"+me.checkMode),me.checkMode="half",me.warp.addClass("c-checkbox-"+me.checkMode),me.checkbox.update('<span class="c-checkbox-half-outer"></span><span class="c-checkbox-half-inner"></span>'),me.fireEvent("changed",me.checkMode,me),me)},toUncheckedMode:function(){var me=this;return me.isUnchecked()?me:(me.warp.removeClass("c-checkbox-"+me.checkMode),me.checkbox.update(""),me.checkMode=!1,me.fireEvent("changed",me.checkMode,me),me)}})}}),Cmp.define("Cmp.form.CheckboxGroup",{extend:"Cmp.form.Field",cls:!0,requires:["Cmp.form.Checkbox"],factory:function(ext,reqs){var superClazz=ext.prototype,checkboxClazz=reqs[0];return Cmp.extend(ext,{setOptions:function(options){var len,op,vv,tx,i,ip,me=this,ips=me.inputs;if(ips){for(i in ips)ip=ips[i],op=Cmp.get(ip.field.el.dom.parentNode),ip.field.destroy(),op.remove();me.inputCount=0,me.inputs={}}for(me.allInput.toUncheckedMode(),i=0,len=isA(options)?options.length:0;i<len;i++){if(op=options[i],isO(op)){if(void 0==(vv=op.value))continue;(tx=op.text)||(tx=vv)}else isS(op)&&(tx=vv=op);(ip=me.appendCheckbox(tx))&&(me.inputs[ip.getId()]={field:ip,value:vv,checked:!1},me.inputCount++)}},getValue:function(){var i,op,ops=this.inputs,rel=[];for(i in ops)(op=ops[i]).checked&&rel.push(op.value);return rel},setValue:function(vs){var i,op,me=this,ops=me.inputs,count=isA(vs)?vs.length:0;if(0!==me.selectCount||0!==count){me.onValueChangeding=!0;for(i in ops)op=ops[i],count>0&&vs.indexOf(op.value)>-1?(op.checked=!0,op.field.toCheckedMode()):(op.checked=!1,op.field.toUncheckedMode());me.selectCount=count,0===me.selectCount?me.allInput.toUncheckedMode():me.inputCount===me.selectCount?me.allInput.toCheckedMode():me.allInput.toHalfCheckedMode(),me.onValueChangeding=!1}},initComponent:function(){var me=this,cls=me.cls;isA(cls)?cls.unshift("c-checkboxgroup"):cls=isS(cls)?["c-checkboxgroup",cls]:"c-checkboxgroup",me.cls=cls,superClazz.initComponent.call(me)},renderInput:function(box){var op,fo,tx,vv,me=this,ops=me.options,i=0,len=isA(ops)?ops.length:0;for(me.allInputBox=box.createChild({cls:"c-checkboxgroup-allinputbox"}),me.allInput=new checkboxClazz({hideLabel:!0,text:"全选"}),me.allInput.on("changed",me.onAllSelectChanged,me),me.allInput.render(me.allInputBox),me.optionBox=box.createChild({cls:"c-checkboxgroup-optionbox"}),me.inputs={},me.inputCount=0,me.selectCount=0;i<len;i++){if(op=ops[i],isO(op)){if(!(vv=op.value))continue;(tx=op.text)||(tx=vv)}else isS(op)&&(tx=vv=op);(fo=me.appendCheckbox(tx))&&(me.inputs[fo.getId()]={field:fo,value:vv,checked:!1},me.inputCount++)}isA(me.value)&&me.setValue(me.value)},appendCheckbox:function(text){var box,rel,me=this;return box=me.optionBox.createChild({cls:"c-checkboxgroup-optionitem"}),(rel=new checkboxClazz({hideLabel:!0,text:text})).on("changed",me.onOptionValueChanged,me),rel.render(box),rel},onAllSelectChanged:function(checkModue,field){var i,op,me=this,inputs=me.inputs;if(!me.onOptionValueChanging&&!me.onValueChangeding){if(me.onAllSelectChanging=!0,field.isCheckeded()){me.selectCount=me.inputCount;for(i in inputs)(op=inputs[i]).checked=!0,op.field.toCheckedMode()}else{me.selectCount=0;for(i in inputs)(op=inputs[i]).checked=!1,op.field.toUncheckedMode()}me.onAllSelectChanging=!1}},onOptionValueChanged:function(checkModue,field){var me=this,op=me.inputs[field.getId()];me.onAllSelectChanging||me.onValueChangeding||!op||(field.isCheckeded()?(op.checked=!0,me.selectCount++):(op.checked=!1,me.selectCount--),me.onOptionValueChanging=!0,0===me.selectCount?me.allInput.toUncheckedMode():me.inputCount===me.selectCount?me.allInput.toCheckedMode():me.allInput.toHalfCheckedMode(),me.onOptionValueChanging=!1)}})}});
//# sourceMappingURL=cmp-ext.min.js.map
